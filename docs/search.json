[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Analysing Genomic Data with dartRverse",
    "section": "",
    "text": "Welcome!\nWelcome, Trailblazers of Biodiversity, to the Second Gathering of our Population Genetics Workshop — this time under the vast skies and red dust of the Australian Outback (well… Brisbane’s subtropical edge of it)!\nWe’re excited to bring this workshop to the International Congress for Conservation Biology (ICCB) — a meeting ground where conservationists from every corner gather to share stories, science, and strategies for protecting the wild heart of our planet. While Brisbane may not boast the rustle of Kioloa’s forests, it hums with its own rhythm — a place where mangroves meet skyscrapers and river currents carry both eDNA and ideas.\nIn this workshop — a compact but powerful expedition — we’ll explore Population Genetics using R. Whether you’re a seasoned fieldworker or new to the code trail, you’re in good company. Here, every voice matters, and learning is a shared journey.\nThis is your chance to sharpen your analytical tools, exchange ideas, and delve into the genomic threads that weave through ecosystems across Australia and beyond. And yes — we’ll get our hands dirty (metaphorically… unless your dataset’s really dusty) with hands-on practice using your own data.\nSo bring your resilience, your field-hardened humour, and your willingness to wrestle a few data-wrangling goannas. Bugs in your code? Think of them as wildlife encounters. We’ll handle it all with tenacity, teamwork, and maybe a bit of data-fuelled bush magic.\nWe’re glad to have you on this journey. Let’s get started.",
    "crumbs": [
      "Welcome!"
    ]
  },
  {
    "objectID": "index.html#program-and-speakers",
    "href": "index.html#program-and-speakers",
    "title": "Analysing Genomic Data with dartRverse",
    "section": "Program and Speakers",
    "text": "Program and Speakers\nWe hope you are ready for a jam-packed PROGRAM! And before getting started why not check out the amazing speakers we have lined up. They are all excited to share their knowledge and expertise.",
    "crumbs": [
      "Welcome!"
    ]
  },
  {
    "objectID": "index.html#here-are-some-things-you-might-see-along-your-journey",
    "href": "index.html#here-are-some-things-you-might-see-along-your-journey",
    "title": "Analysing Genomic Data with dartRverse",
    "section": "Here are some things you might see along your journey:",
    "text": "Here are some things you might see along your journey:\nBelow is an exercise box, this is encouraging you to give it a go yourself!\n\n\n\n\n\n\nExercise\n\n\n\n Give the code a go!\n\n\nBelow is a tip box, with added insights for your journey.\n\n\n\n\n\n\nTip\n\n\n\ntake a look…\nA variety of things to learn!\n\n\nBelow is a caution box, take note, this will keep you on your path.\n\n\n\n\n\n\nCaution\n\n\n\nTake CARE! It is easy to go astray, I am here to help.\n\n\nBelow is a warning box! Be careful and take head of what it says.\n\n\n\n\n\n\nWarning\n\n\n\nNOTICE! Thank you for noticing this warning!",
    "crumbs": [
      "Welcome!"
    ]
  },
  {
    "objectID": "index.html#a-big-thank-you-to-the-developers",
    "href": "index.html#a-big-thank-you-to-the-developers",
    "title": "Analysing Genomic Data with dartRverse",
    "section": "A big thank you to the developers!",
    "text": "A big thank you to the developers!\nDartR published first by Gruber et al. (2018), and DartR V2 published by Mijangos et al. (2022)\n\n\n\n\nGruber, Bernd, Peter J. Unmack, Oliver F. Berry, and Arthur Georges. 2018. “DARTR : An R Package to Facilitate Analysis of SNP Data Generated from Reduced Representation Genome Sequencing.” Molecular Ecology Resources 18 (3): 691–99. https://doi.org/10.1111/1755-0998.12745.\n\n\nMijangos, Jose Luis, Bernd Gruber, Oliver Berry, Carlo Pacioni, and Arthur Georges. 2022. “dartR V2: An Accessible Genetic Analysis Platform for Conservation, Ecology and Agriculture.” Methods in Ecology and Evolution 13 (10): 2150–58. https://doi.org/10.1111/2041-210X.13918.",
    "crumbs": [
      "Welcome!"
    ]
  },
  {
    "objectID": "schedule.html",
    "href": "schedule.html",
    "title": "Program",
    "section": "",
    "text": "#\nDay\nTime\nTopic\nPresenters\n\n\n\n\n1\nSaturday\n9 am – 11 am\nImporting and Handling Genomic Data\nArthur Georges, Diana Robledo\n\n\n2\n\n11:20 am – 12:50 pm\nEstimating Effective Population Size and Key Stats\nBernd Gruber, Luis Mijangos\n\n\n3\n\n1:30 pm – 3 pm\nIdentifying Population Structure\nLuis Mijangos, Emily Stringer\n\n\n4\n\n3:30 pm – 5 pm\nKinship, Pedigrees & Mating Recommendations\nLuis Mijangos, Bernd Gruber\n\n\n5\nSunday\n9 am – 11 am\nAssigning Individuals to Populations\nArthur Georges, Luis Mijangos, Elise Furlan\n\n\n6\n\n11:30 am – 12:30 pm\nSNP Panel Selection\nElise Furlan, Bernd Gruber, Andrzej Killian\n\n\n7\n\n1:10 pm – 2:10 pm\nSimulations for Conservation\nLuis Mijangos, Bernd Gruber\n\n\nBonus!\n\n2:10 pm – 3 pm\nSex Linked Markers\nDiana Robledo",
    "crumbs": [
      "Program"
    ]
  },
  {
    "objectID": "speakers.html",
    "href": "speakers.html",
    "title": "Speaker Bios",
    "section": "",
    "text": "Elise Furlan is a Senior Research Fellow with the eDNA Team at the University of Canberra, where she applies molecular genetic techniques to tackle a wide range of ecological questions. One of the early trailblazers in Australia’s environmental DNA (eDNA) space, Elise was among the first researchers in the country to develop methods for analysing eDNA — detecting species from the tiny traces they leave behind in the environment. Her main objective is to ensure her high quality research results in applied outcomes for conservation, therefore partnerships with government agencies and industry feature heavily in her projects. session 4 and session 6\nArthur Georges, a distinguished professor at the University of Canberra, has revolutionized the understanding of sex determination in reptiles. His major achievement? Unravelling how environmental factors influence sex in reptiles, a game-changer in herpetology and conservation genetics. Arthur’s work has far-reaching implications, from conservation strategies to understanding evolutionary processes. He’s the Dumbledore of herpetology, albeit more fascinated by dragon eggs than by magic ones, and probably wonders if he could genetically engineer a lizard to brew his morning coffee. session 1 and session 4\nBernd Gruber, from the University of Canberra, is a master at blending spatial and ecological modelling with genetics. His crowning achievement? Developing dartR, a tool that’s revolutionizing genetic data analysis in conservation projects. His approach to research is as innovative as it is impactful, making him the Houdini of ecology – he makes complex data disappear into meaningful conservation strategies. Bernd might secretly wish to decode the genetic basis for why every odd sock goes missing, solving one of life’s great mysteries.session 2, session 5, and session 6\nAndrzej Kilian, founder of DArT in 2001, has been a pioneer in genomics, creating a technology that simplifies high-throughput genotyping across various organisms. His work at DArT supports global food security, sustainable agriculture, and biodiversity, making significant strides towards understanding and improving agricultural and environmental practices. Andrzej’s commitment to science and humanity illustrates a unique blend of innovation with a purpose. Andrzej, much like a maestro in an orchestra of genomes, harmonizes the complex notes of genetics to compose a symphony for a sustainable planet, ensuring every note contributes to the grander vision of global harmony and well-being. session 4\nLuis Mijangos, at DArT, he combines his passion for technology and conservation, using genetic data analysis to protect biodiversity. His standout achievement? Applying his expertise in genetic data analysis to conservation projects, making him the tech-savvy guardian of the planet. Luis’s contributions are crucial in the fight against biodiversity loss, and he’s probably brainstorming ways to use genetic data to convince plants to grow in perfect Instagram-worthy arrangements. session 2, session 3, session 4, session 5, and session 6\nDiana Robledo-Ruiz is a name you’ll want to remember in the field of conservation biology, specifically at Monash University. She’s been making waves with her work on the Helmeted Honeyeater’s genome, leading to significant advancements in genetic rescue operations. Her high-quality genomic research is not just for the birds – it’s key to saving them from extinction and maintaining their unique identity. Diana is also the lead developer of dartR.sexlinked which will make your life easier when filtering genetic data! She is developing this and other genomic tools to keep the endangered Helmeted Honeyeater, Leadbeater’s possum and Macquarie perch buzzing in the wild. session 1 and session 3\nEmily Stringer recently completed her PhD (Whooh!) at the University of Canberra, diving deep into conservation ecology and genomics. She kicked off with a mission to save the elusive Canberra grassland earless dragon and then hopped into the world of population genetics. Her main gig? Unraveling the genetic puzzle of an Australian rodent known for its dramatic population swings. Emily’s all about cracking complex data to solve ecological mysteries, aiming to turn her findings into real-world conservation victories. session 2, session 3, and session 6. She also put this website together for you all :)",
    "crumbs": [
      "Speaker Bios"
    ]
  },
  {
    "objectID": "install.html",
    "href": "install.html",
    "title": "Install dartRverse",
    "section": "",
    "text": "Install dartRverse",
    "crumbs": [
      "Install dartRverse"
    ]
  },
  {
    "objectID": "install.html#rationale",
    "href": "install.html#rationale",
    "title": "Install dartRverse",
    "section": "Rationale",
    "text": "Rationale\nWe have developed a new suit of packages called “dartRverse” packages, that will replace the previous dartR package, which soon will be no longer supported. The new suit of packages are meant to be a 1:1 replacement and only in some instance very minor changes will be needed to update previous code. For example we reworked on the “output” of all functions, now being able to save figures in specified folders, which can be easier recovered and manipulated for further tweaking. The main reasons for splitting dartR into several packages and developing the dartRverse suit of packages was difficulty to maintain dartR, because of limits imposed by CRAN, but also limits due the the long time to test new function, when compiling the package. Therefore we were forced to split the package into several smaller packages. This has several advantages and in the best of all cases no disadvantages.\n\neasier maintenance\nfaster development\nless dependencies on other packages\neasier to become a contributor\nhave your own package developed that can be branded as part of the dartRverse\n\nThe main paradigm was also that for our users nothing (or at as little as possible) needed to change and all existing code and scripts should still work. Also the installation process was meant to be straightforward and finally the coexistance between dartR and dartRverse packages should be possible (for the interim until dartR will be no longer supported).",
    "crumbs": [
      "Install dartRverse"
    ]
  },
  {
    "objectID": "install.html#installation",
    "href": "install.html#installation",
    "title": "Install dartRverse",
    "section": "Installation",
    "text": "Installation\n\ninstall dartRverse\n\n#installs the necessary bioconductor packages\ninstall.packages(\"devtools\")\ninstall.packages(\"BiocManager\")\nBiocManager::install(\"SNPRelate\")\n\n#install dartRverse (dartRverse) & core (dartR.base, dartR.data)\ninstall.packages(\"dartRverse\")\n\nThe dartRverse package is the first package to install and its only purpose is to support the installation of the other dartRverse packages. It will also be the first port of call to provide links to tutorials and other documentation.\nIf everything works well this should install two more packages with form the core version of dartRverse, nameley dartR.base and dartR.data. Those core packages have all the main function of old dartR package that deals with input, conversion, reporting and filtering of data. Also some base function to analysse data (e.g. PCoA, Fst) are included.\nOnce the dartRverse package has been installed we can load the package to check which part of the dartRverse has been installed.\n\nlibrary(dartRverse)\n\n\n\n\n\n\n\n\ninstall additional packages\nNow we can install the additional packages that are part of the dartRverse. Depending on your needs you can install all of them or only the one you are interested.\nFor example if you are interested in additional functions to analyse population structure (e.g. run STRUCTURE or faststructure) you can install the dartR.popgen package. If you are interested in functions that support the simulation of data you can install the dartR.sim package.\nYou can check which packages are avaialbel and which of them you have installed by typing:\n\ndartRverse::dartRverse_install()\n\n\n\n\n\n\nThe currently available packages are:\n\ndartR.sim (simulate SNP data)\ndartR.popgen (run population genetic analysis)\ndartR.spatial (run landscape genetic analysis)\ndartR.captive (estimate relatedness, support captive breeding)\ndartR.sexlinked (identify sexlinked markers, not ready yet)\n\nSo to install the dartR.sim simply type:\n\ninstall.packages(\"dartR.sim\")\ninstall.packages(\"dartR.popgen\")\ninstall.packages(\"dartR.spatial\")\ninstall.packages(\"dartR.captive\")\n# currently dartR.sexlinked requires a different installation process (see below)\n\n\n\nGithub repositories\nWe make all of our packages available via CRAN. The reason for this is that CRAN packages follow a stringent testing before they are allowed to be uploaded to CRAN and therefore are more likely to contain less errors then packages that are available on other repositories. Nevertheless we also make our packages available during development via github.\nYou can find the repositories under: https://github.com/green-striped-gecko/dartR.base [for the dartR.base package] and equivalent for the other packages.\nThe reason why you might want to install a package from github is that you want to use the latest version of the package. However, you should be aware that the packages on github are not tested and therefore might contain errors. Also the packages on github might be updated on a daily basis and therefore might change without notice.\nWe use different branches and they are reflecting different stages of development and majurity.\n\nmain (the main branch, which is equivalent to the current CRAN version)\ndev (development branch, which has the latest functions that might be in the next CRAN version, but have not been tested yet)\ndev_name (these are branches of our main developers and are used for testing and development of new functions. Installing functions from here might cause problems and should only be done if you know what you are doing)\n\ndartRverse supports the installation of github version of the packages using the following syntax:\ndartRverse_install(package = \"dartR.base\", repo = \"github\", branch = \"dev\")\nThis install the dev branch of dartR.base from CRAN. All main and dev branches are tested if they can be installed (and some additional error checks via): https://github.com/green-striped-gecko/dartRverse\nPlease note that you should provide the package repository (github/cran), the branch (main, dev,dev_name) and version number in case you want to report a bug. You can use the github methods to report issues or use our google group: https://groups.google.com/d/forum/dartr.\n\n\nInstalling dartR.sexlinked\ndartRverse_install(package = \"dartR.sexlinked\", repo = \"github\", branch = \"dev\")",
    "crumbs": [
      "Install dartRverse"
    ]
  },
  {
    "objectID": "install.html#using-dartrverse",
    "href": "install.html#using-dartrverse",
    "title": "Install dartRverse",
    "section": "Using dartRverse",
    "text": "Using dartRverse\nTo use dartRverse you can simply load the package and use it as before.\n\nlibrary(dartRverse)",
    "crumbs": [
      "Install dartRverse"
    ]
  },
  {
    "objectID": "breakk.html",
    "href": "breakk.html",
    "title": "__________",
    "section": "",
    "text": "And without further ado lets get into the workshop",
    "crumbs": [
      "\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_"
    ]
  },
  {
    "objectID": "session01.html",
    "href": "session01.html",
    "title": "1  Importing and Handling Genomic Data",
    "section": "",
    "text": "Required packages\nSession Presenters\nlibrary(dartRverse)\nlibrary(dartR.sexlinked)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Importing and Handling Genomic Data</span>"
    ]
  },
  {
    "objectID": "session01.html#dartr-fundamentals",
    "href": "session01.html#dartr-fundamentals",
    "title": "1  Importing and Handling Genomic Data",
    "section": "dartR Fundamentals",
    "text": "dartR Fundamentals\nJust before you get started how about checking out some prerequisite tutorials if you are not up to date. These are the following two tutorials RStudio refresher and installing dartR.\n\n\n\n\n\n\nAlso a little reminder about dartRverse:\n\n\n\nAn accessible genetic analysis platform for conservation, ecology and agriculture\ndartRverse aims to support the installation of R packages of the dartRverse that are user-friendly and deliver a variety of analyses and pipelines on the one platform. Currently there are two core R packages that need to be installed to use dartR:\n\ndartR.base\ndartR.data\n\nAdditional packages are\n\ndartR.sim (functions to simulate SNP data)\ndartR.spatial (spatial analysis)\ndartR.popgenomics (popgenomics analysis)\ndartR.captive\ndartR.sexlinked\n\ndartR is a collaboration between the University of Canberra, CSIRO and Diversity Arrays Technology, and is supported with funding from the ACT Priority Investment Program, CSIRO and the University of Canberra.\n\n\n\nIntroduction\nSNPs, or single nucleotide polymorphisms, are single base pair mutations at a nuclear locus (Figure 2). That nuclear locus is represented in the dataset by two sequence tags which, at a heterozygous locus, take on two allelic states, one referred to as the reference state, the other as the alternate or SNP state.\n\n\n\nFigure 2. A diagram illustrating what is meant by a SNP (single point polymorphism)\n\n\nBecause it is extremely rare for a mutation to occur twice at the same site in the genome (perhaps with the exception of Eucalypts), the SNP data are considered to be effectively biallelic. Sites with more than two states that occur rarely are typically eliminated in the quality control steps as they are bundled with multiallelic sites arising from multiple copy sequences (e.g. as would arise from gene duplications) removed during preliminary filtering.\nThe data can be represented as SNP bases (A, T, C or G), with two states for each individual at each locus in a diploid organisms. Alternatively, because the data are biallelic, it is computationally convenient to code the data as 0 for homozyogotes for one allele, 1 for heterozygotes, and 2 for homozygotes of the other allele. The reference allele is arbitrarily taken to be the most common allele, so 0 is the score for homozygous reference, and 2 is the score for homozygous alternate or SNP state. NA indicates that the SNP could not be scored.\nSNP data when using dartR are held in a genlight object that is defined in R package adegenet (Jombart, 2008; Jombart and Ahmed, 2011). The locus metadata included in the genlight object are those provided as part of your Diversity Arrays Technology report. These metadata are obtained from the Diversity Arrays Technology csv file when it is read in to the genlight object. The locus metadata are held in an R data.frame that is associated with the SNP data as part of the genlight object.\nHere is an example of the data structure of a genlight object\n\n\n\n\n\nFor further details go check out the Data Structure tutorial.\n\n\nExample\nTo help us get our head around data interrogation, subsetting, and basic filtering we are going to work through a worked example using a test dataset.\n\n# dartR comes with a built in test dataset called testset.gl. \n# We first examine the contents of testset.gl\ntestset.gl\n\nHow many individuals have been genotyped? How many SNP loci have been scored? What is the percentage of missing data?\n\n\n\n\n\n\nQuiz!\n\n\n\nThis quiz is referring to the testset.gl data set you have interrogated above.\nType the correct number into the blank boxes below:\n\nnumber of SNPs \nnumber of individuals \npercent missing data \n\nboxes will go green if you have the answer correct\n\n\n\n# Next let us copy the contents of testset.gl to another genlight object called gl.\ngl &lt;- testset.gl\n# Use adegenet accessors to interrogate the genlight object further\nnInd(gl)\nnLoc(gl)\nnPop(gl)\npopNames(gl)\nindNames(gl)\nlocNames(gl)\n\nNow you have a better appreciation of the contents of genlight object gl. pop(gl) is a vector of population names against each individual. Note that it is distinguished from popNames(gl) which just lists the unique names.\n\n# So if you want to tablulate the number of individuals in each population, use\ntable(pop(gl))\n\n\n   EmmacBrisWive    EmmacBurdMist    EmmacBurnBara    EmmacClarJack \n              10               10               11                5 \n   EmmacClarYate    EmmacCoopAvin   EmmacCoopCully    EmmacCoopEulb \n               5               10               10               10 \n  EmmacFitzAllig    EmmacJohnWari    EmmacMaclGeor    EmmacMaryBoru \n              10               10               11                6 \n   EmmacMaryPetr     EmmacMDBBowm     EmmacMDBCond     EmmacMDBCudg \n               4               10               10               10 \n    EmmacMDBForb     EmmacMDBGwyd     EmmacMDBMaci EmmacMDBMurrMung \n              11                9               10               10 \n    EmmacMDBSanf    EmmacNormJack    EmmacNormLeic    EmmacNormSalt \n              10                6                1                1 \n   EmmacRichCasi        EmmacRoss    EmmacRussEube     EmmacTweeUki \n              10               10               10               10 \n   EmsubRopeMata    EmvicVictJasp \n               5                5 \n\n\nWe have learned that typing the name of the genlight object gives its attributes. How do we examine the genotypes in a genlight object. This is done by converting it to a matrix.\n\nas.matrix(gl)[1:7,1:5]\n\nWhat do you see. Is it what you expected for the coding of the SNP scores?\nLets start again.\n\n# Copy the original testset.gl\ngl &lt;- testset.gl\n# Set the global verbosity to 3 – this will result in some detailed comments as you run each # script\ngl.set.verbosity(3)\n# Now lets use a report function to report the call rate for genlight object gl\ngl.report.callrate(gl)\n\n\n\n\n\n\n\nTip\n\n\n\nNote that the call rate is reported against locus. This is the default. Both a tabulated result and a graph is produced. You can use both to determine a suitable threshold for filtering on callrate.\nWhat threshold do you think might be appropriate?\n\n\nNow let’s report the call rate for genlight object gl by individual.\n\ngl.report.callrate(gl,method=\"ind\")\n\nCan you see the difference. Again, both a tabulated result and a graph is produced. You can use both to determine a suitable threshold for filtering on callrate. What threshold do you think might be appropriate?\nWhat about reproducibility?\n\ngl.report.reproducibility(gl)\n\n\n\n\n\n\n\nTip\n\n\n\nRecall that DArT runs a series of technical replicates as part of its routine workflow. This enables an assessment of the quality of data associated with each locus. What threshold do you think might be appropriate for a filter of reproducability?\n\n\nNow let’s try some filtering. Return to call rate.\n\n# First look at a report to decide a threshold\ngl.report.callrate(gl,method=\"ind\")\n# Then filter using that threshold\ngl &lt;- gl.filter.callrate(gl, method=\"ind\", threshold=0.80)\n# Use a smear plot for a visual assessment of the effectiveness of filtering\ngl &lt;- testset.gl\ngl.smearplot(gl)\n\n\n\n\n\n\n\nTip\n\n\n\nNote the whitespace, which indicates missing data.\n\n\n\n# Filter on callrate by locus, then on individual\ngl &lt;- gl.filter.callrate(gl,verbose=0)\ngl &lt;- gl.filter.callrate(gl, method= \"ind\", threshold=0.80, verbose=0)\n\n# Examine the smearplot again\ngl.smearplot(gl)\n\nWhat has happened. What do you conclude?\n\n\nExercise\n\nFiltering out sex-linked markers\nFor this exercise we will use the data of the Leadbeater’s possum (LBP). This data is included in the package dartR.sexlinked\n\n\n\nThe Leadbeater’s possum :)\n\n\n\n# Load data\nLBP                   # Explore the dataset\nLBP@n.loc             # Number of SNPs\nlength(LBP@ind.names) # Number of individuals\n\n\n\n\n\n\n\nQuestion:\n\n\n\n How many SNPs and individuals does the LBP genlight object have?\nType the correct number into the blank boxes below:\n\nnumber of SNPs \nnumber of individuals \n\nboxes will go green if you have the answer correct\n\n\n\nRun gl.report.sexlinked\nThis function identifies sex-linked and autosomal loci present in a SNP dataset (i.e., genlight object) using individuals with known sex. It identifies five types of loci: w-linked or y-linked, sex-biased, z-linked or x-linked, gametologous and autosomal.\n\n\n\n\n\n\nTip\n\n\n\nThe genlight object must contain in gl\\@other\\$ind.metrics a column named id, and a column named sex in which individuals with known-sex are assigned M for male, or F for female. The function ignores individuals that are assigned anything else or nothing at all (unknown-sex).\n\n\n Check that ind.metrics has the necessary columns:\n\nhead(LBP@other$ind.metrics)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid\nsex\npop\nYear.collected\nservice\nplate_location\n\n\n\n\nY2\nY2\nF\nYellingbo\n1997\nDLpos17-2786\n1-A1\n\n\nY16\nY16\nM\nYellingbo\n2001\nDLpos17-2786\n1-A10\n\n\nY17\nY17\nF\nYellingbo\n1997\nDLpos17-2786\n1-A11\n\n\nY18\nY18\nF\nYellingbo\n1999\nDLpos17-2786\n1-A12\n\n\nY3\nY3\nF\nYellingbo\n1997\nDLpos17-2786\n1-A2\n\n\nY4\nY4\nM\nYellingbo\n1997\nDLpos17-2786\n1-A3\n\n\n\n\n\n Check the manual of function gl.report.sexlinked to investigate its other requirements:\n\nhelp(gl.report.sexlinked)\n\nstarting httpd help server ... done\n\n\n Run the function to identify sex-linked loci in the LBP genlight object:\n\nout &lt;- gl.report.sexlinked(LBP, system = \"xy\")\n\nStarting gl.report.sexlinked \n  Processing genlight object with SNP data\n\n\nDetected 162 females and 211 males.\n\n\nStarting phase 1. May take a while...\n\n\nBuilding call rate plot.\n\n\nDone building call rate plot.\n\n\nStarting phase 2. May take a while...\n\n\nBuilding heterozygosity plot.\n\n\nDone building heterozygosity plot.\n\n\n**FINISHED** Total of analyzed loci: 1000.\nFound 77 sex-linked loci:\n   1 Y-linked loci\n   9 sex-biased loci\n   66 X-linked loci\n   1 gametologs.\nAnd 923 autosomal loci.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCompleted: gl.report.sexlinked \n\n\n\n\n\n\n\n\nQuestion time\n\n\n\nQuestion: Why are we using “xy”?\nQuestion: How many males and females does the dataset contain?\nQuestion: How many sex-linked loci were found?\n\n\nThe output consists of two plots, plus a table. Examine the plots.\n\n\n\n\n\n\nNote\n\n\n\nQuestion: What do the colours mean in the plots? Look at the figure below for a hint.\n\n\n\n\n\nSex-linked loci in XY sex determination systems\n\n\n Now check the output table:\n\nout\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nindex\ncount.F.miss\ncount.M.miss\ncount.F.scored\ncount.M.scored\nratio\np.value\np.adjusted\nscoringRate.F\nscoringRate.M\ny.linked\nsex.biased\ncount.F.het\ncount.M.het\ncount.F.hom\ncount.M.hom\nstat\nstat.p.value\nstat.p.adjusted\nheterozygosity.F\nheterozygosity.M\nx.linked\ngametolog\n\n\n\n\n28681424-34-G/T\n1\n0\n1\n162\n210\n1.2953770\n1.0000000\n1.0000000\n1.0000000\n0.9952607\nFALSE\nFALSE\n1\n0\n161\n210\n1.3033972\n1.0000000\n1.0000000\n0.0061728\n0.0000000\nFALSE\nFALSE\n\n\n28678947-56-C/T\n2\n12\n8\n150\n203\n2.0261283\n0.1638428\n1.0000000\n0.9259259\n0.9620853\nFALSE\nFALSE\n9\n7\n141\n196\n1.7841965\n0.3044519\n0.9598961\n0.0600000\n0.0344828\nFALSE\nFALSE\n\n\n28680567-32-T/G\n3\n12\n12\n150\n199\n1.3256351\n0.5289429\n1.0000000\n0.9259259\n0.9431280\nFALSE\nFALSE\n9\n11\n141\n188\n1.0906350\n1.0000000\n1.0000000\n0.0600000\n0.0552764\nFALSE\nFALSE\n\n\n28688313-7-C/G\n4\n0\n0\n162\n211\n1.3015303\n1.0000000\n1.0000000\n1.0000000\n1.0000000\nFALSE\nFALSE\n6\n0\n156\n211\n8.0761921\n0.0459068\n0.3917911\n0.0370370\n0.0000000\nFALSE\nFALSE\n\n\n28681679-51-C/T\n5\n22\n30\n140\n181\n0.9482168\n0.8814171\n1.0000000\n0.8641975\n0.8578199\nFALSE\nFALSE\n1\n1\n139\n180\n1.2939001\n1.0000000\n1.0000000\n0.0071429\n0.0055249\nFALSE\nFALSE\n\n\n28681994-14-G/A\n6\n0\n1\n162\n210\n1.2953770\n1.0000000\n1.0000000\n1.0000000\n0.9952607\nFALSE\nFALSE\n18\n19\n144\n191\n1.2557905\n0.6007790\n1.0000000\n0.1111111\n0.0904762\nFALSE\nFALSE\n\n\n28687273-35-G/A\n7\n2\n2\n160\n209\n1.3052926\n1.0000000\n1.0000000\n0.9876543\n0.9905213\nFALSE\nFALSE\n64\n81\n96\n128\n1.0533255\n0.8302485\n1.0000000\n0.4000000\n0.3875598\nFALSE\nFALSE\n\n\n28679824-59-A/G\n8\n11\n6\n151\n205\n2.4828757\n0.0823245\n0.9968818\n0.9320988\n0.9715640\nFALSE\nFALSE\n52\n62\n99\n143\n1.2108041\n0.4225316\n1.0000000\n0.3443709\n0.3024390\nFALSE\nFALSE\n\n\n28684498-48-C/T\n9\n32\n40\n130\n171\n1.0521355\n0.8949886\n1.0000000\n0.8024691\n0.8104265\nFALSE\nFALSE\n1\n1\n129\n170\n1.3165942\n1.0000000\n1.0000000\n0.0076923\n0.0058480\nFALSE\nFALSE\n\n\n28686771-26-C/T\n10\n1\n0\n161\n211\n1.3095886\n1.0000000\n1.0000000\n0.9938272\n1.0000000\nFALSE\nFALSE\n54\n79\n107\n132\n0.8436386\n0.4470382\n1.0000000\n0.3354037\n0.3744076\nFALSE\nFALSE\n\n\n28685826-39-C/A\n11\n11\n10\n151\n201\n1.4626962\n0.4976794\n1.0000000\n0.9320988\n0.9526066\nFALSE\nFALSE\n2\n0\n149\n201\n2.6904699\n0.5782830\n1.0000000\n0.0132450\n0.0000000\nFALSE\nFALSE\n\n\n28685909-47-A/G\n12\n1\n3\n161\n208\n0.4315262\n0.6359454\n1.0000000\n0.9938272\n0.9857820\nFALSE\nFALSE\n19\n15\n142\n193\n1.7189806\n0.1483226\n0.7656290\n0.1180124\n0.0721154\nFALSE\nFALSE\n\n\n28684339-40-T/C\n13\n8\n10\n154\n201\n1.0440609\n1.0000000\n1.0000000\n0.9506173\n0.9526066\nFALSE\nFALSE\n33\n38\n121\n163\n1.1693320\n0.5934502\n1.0000000\n0.2142857\n0.1890547\nFALSE\nFALSE\n\n\n28679629-14-C/T\n14\n5\n6\n157\n205\n1.0878623\n1.0000000\n1.0000000\n0.9691358\n0.9715640\nFALSE\nFALSE\n28\n44\n129\n161\n0.7947239\n0.4270510\n1.0000000\n0.1783439\n0.2146341\nFALSE\nFALSE\n\n\n28679675-66-C/T\n15\n2\n0\n160\n211\n2.6307469\n0.5810799\n1.0000000\n0.9876543\n1.0000000\nFALSE\nFALSE\n5\n9\n155\n202\n0.7246290\n0.7844119\n1.0000000\n0.0312500\n0.0426540\nFALSE\nFALSE\n\n\n28679229-66-T/C\n16\n3\n3\n159\n208\n1.3072117\n1.0000000\n1.0000000\n0.9814815\n0.9857820\nFALSE\nFALSE\n43\n65\n116\n143\n0.8159706\n0.4192173\n1.0000000\n0.2704403\n0.3125000\nFALSE\nFALSE\n\n\n28690243-21-G/A\n17\n3\n15\n159\n196\n0.2473174\n0.0259465\n0.5976030\n0.9814815\n0.9289100\nFALSE\nFALSE\n23\n0\n136\n196\n32.9246419\n0.0000001\n0.0000013\n0.1446541\n0.0000000\nTRUE\nFALSE\n\n\n28681769-49-T/G\n18\n1\n0\n161\n211\n1.3095886\n1.0000000\n1.0000000\n0.9938272\n1.0000000\nFALSE\nFALSE\n29\n40\n132\n171\n0.9393419\n0.8931260\n1.0000000\n0.1801242\n0.1895735\nFALSE\nFALSE\n\n\n28691027-42-G/A\n19\n2\n3\n160\n208\n0.8670091\n1.0000000\n1.0000000\n0.9876543\n0.9857820\nFALSE\nFALSE\n11\n1\n149\n207\n15.1955169\n0.0006362\n0.0095436\n0.0687500\n0.0048077\nTRUE\nFALSE\n\n\n28681640-28-G/A\n20\n6\n5\n156\n206\n1.5826038\n0.5425067\n1.0000000\n0.9629630\n0.9763033\nFALSE\nFALSE\n24\n40\n132\n166\n0.7551270\n0.3339841\n0.9919948\n0.1538462\n0.1941748\nFALSE\nFALSE\n\n\n\n\n\nonly showing the first 20 rows\n\n\nRun gl.drop.sexlinked\n Remove the sex-linked loci from the LBP genlight object:\n\nnew.gl &lt;- gl.drop.sexlinked(LBP, system = \"xy\")\nnew.gl\nnew.gl@n.loc\n\n\n\n\n\n\n\nNote\n\n\n\nQuestion: How many SNPs are there left after removing sex-linked loci?\n\nnumber of SNPs \n\n\n\n\n\n\nMore filtering\n\n\n\n\n\n\nKnock yourself out trying all the different report and filtering functions\n\n\n\nRemember to use them as pairs – report function to decide a threshold, filter function to apply the threshold (where appropriate)\nHow about trying it with a different dataset?\n\n\n\n\n\n\n Download SNP data (2 row)\n\n\n\n\n\n\n\n\n\n Download metadata\n\n\n\n\n# how to load a genlight object\ngl &lt;- gl.read.dart(filename=\"./data/sample_data_2Row.csv\", \n                   ind.metafile=\"./data/sample_metadata.csv\")\n\nYou can even try it with your own data.\n\n\n\n\n\n\n\n\n\nReport functions\ndescription\n\n\n\n\ngl.report.callrate\nsummarises CallRate values\n\n\ngl.report.reproducibility\nsummarises repAvg (SNP) or reproducibility (SilicoDArT) values.\n\n\ngl. report.monomorphs\nprovides a count of polymorphic and monomorphic loci\n\n\ngl.report.secondaries\nprovides a count of loci that are secondaries, that is, loci that reside on the one sequence tag.\n\n\ngl.report.rdepth\nreports the estimate of average read depth for each locus\n\n\ngl.report.hamming\nreports on Hamming distances between sequence tags\n\n\ngl.report.overshoot\nreports loci for which the SNP has been trimmed along with the adaptor sequence\n\n\ngl.report.taglength\nreports a frequency tabulation of sequence tag lengths\n\n\ngl.report.sexlinked\nreports the number and type of loci likely to be in sex chromosomes\n\n\n\n\n\n\n\n\n\n\nFilter functions\ndescription\n\n\n\n\ngl.filter.callrate\nfilter out loci or individuals for which the call rate (rate of non-missing values) is less than a specified threshold, say threshold = 0.95\n\n\ngl.filter.reproducibility\nfilter out loci for which the reproducibility (strictly repeatability) is less than a specified threshold, say threshold = 0.99\n\n\ngl. filter.monomorphs\nprovides a count of polymorphic and monomorphic loci\n\n\ngl.filter.allna\nfilter out loci that are all missing values (NA)\n\n\ngl.filter.secondaries\nfilter out SNPs that share a sequence tag, except one retained at random [or the best based on reproducibility (RepAvg) and information content (AvgPIC)].\n\n\ngl.filter.rdepth\nfilter out loci with exceptionally low or high read depth (coverage)\n\n\ngl.filter.hamming\nfilter out loci that differ from each other by less than a specified number of base pairs\n\n\ngl.filter.overshoot\nfilter out loci where the SNP location lies outside the trimmed sequence tag\n\n\ngl.filter.taglength\nfilter out loci for which the tag length is less that a threshold\n\n\ngl.filter.sexlinked\nfilter out loci that are likely to be in sex chromosomes",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Importing and Handling Genomic Data</span>"
    ]
  },
  {
    "objectID": "session01.html#further-study",
    "href": "session01.html#further-study",
    "title": "1  Importing and Handling Genomic Data",
    "section": "Further Study",
    "text": "Further Study\nFor more tuturials see the dartR Tutorials section.\nCheck out the other functions contained in package dartR.sexlinked. What do they do?\nKeep your eyes peeled for Session 8!\n\nReadings\nGruber et al. (2018)\nMijangos et al. (2022)\nJombart and Ahmed (2011)\nRobledo-Ruiz et al. (2023)\n\n\n\n\nGruber, Bernd, Peter J. Unmack, Oliver F. Berry, and Arthur Georges. 2018. “DARTR : An R Package to Facilitate Analysis of SNP Data Generated from Reduced Representation Genome Sequencing.” Molecular Ecology Resources 18 (3): 691–99. https://doi.org/10.1111/1755-0998.12745.\n\n\nJombart, T., and I. Ahmed. 2011. “Adegenet 1.3-1: New Tools for the Analysis of Genome-Wide SNP Data.” Bioinformatics. https://doi.org/10.1093/bioinformatics/btr521.\n\n\nMijangos, Jose Luis, Bernd Gruber, Oliver Berry, Carlo Pacioni, and Arthur Georges. 2022. “dartR V2: An Accessible Genetic Analysis Platform for Conservation, Ecology and Agriculture.” Methods in Ecology and Evolution 13 (10): 2150–58. https://doi.org/10.1111/2041-210X.13918.\n\n\nRobledo-Ruiz, Diana A., Lana Austin, J. Nevil Amos, Jesús Castrejón-Figueroa, Daniel K. P. Harley, Michael J. L. Magrath, Paul Sunnucks, and Alexandra Pavlova. 2023. “Easy-to-Use R Functions to Separate Reduced-Representation Genomic Datasets into Sex-Linked and Autosomal Loci, and Conduct Sex Assignment.” Molecular Ecology Resources 0 (n/a). https://doi.org/10.1111/1755-0998.13844.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Importing and Handling Genomic Data</span>"
    ]
  },
  {
    "objectID": "session02.html",
    "href": "session02.html",
    "title": "2  Estimating Effective Population Size and Key Stats",
    "section": "",
    "text": "Required packages\nSession Presenters\nlibrary(dartR.base)\nlibrary(dartR.data)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Estimating Effective Population Size and Key Stats</span>"
    ]
  },
  {
    "objectID": "session02.html#session-content",
    "href": "session02.html#session-content",
    "title": "2  Estimating Effective Population Size and Key Stats",
    "section": "Session Content",
    "text": "Session Content",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Estimating Effective Population Size and Key Stats</span>"
    ]
  },
  {
    "objectID": "session02.html#further-study",
    "href": "session02.html#further-study",
    "title": "2  Estimating Effective Population Size and Key Stats",
    "section": "Further Study",
    "text": "Further Study\n\nReadings",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Estimating Effective Population Size and Key Stats</span>"
    ]
  },
  {
    "objectID": "session03.html",
    "href": "session03.html",
    "title": "3  Identifying Population Structure",
    "section": "",
    "text": "Required packages\nSession Presenters\nAs always we need to have dartRverse installed and loaded. In addition you need to have dartR.popgen installend.\nlibrary(dartRverse)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Identifying Population Structure</span>"
    ]
  },
  {
    "objectID": "session03.html#uncovering-population-structure",
    "href": "session03.html#uncovering-population-structure",
    "title": "3  Identifying Population Structure",
    "section": "Uncovering Population Structure",
    "text": "Uncovering Population Structure\n\nIntroduction\nWhy population structure matters\n\nWhat is a “population” in population genetics?\nGenetic structure defined – how allele frequencies vary among groups.\nKey drivers: effective population size, gene flow/immigration, natural selection, drift.\nIsolation-by-distance & sampling design – avoiding spurious structure.\nWhy we care: management units, inbreeding, local adaptation, introgression.\n\n\nAnalytical toolkit\n\n\n\n\n\n\n\n\nApproach\nPurpose\ndartR entry point\n\n\nPCoA / PCA\nQuick multivariate overview\ngl.pcoa(), gl.pcoa.plot()\n\n\nSTRUCTURE\nBayesian clustering\ngl.run.structure(), gl.plot.structure(), gl.map.structure()\n\n\nfastSTRUCTURE\nFast variational STRUCTURE (Mac/Linux)\ngl.run.faststructure(), gl.plot.faststructure()\n\n\nsNMF\nSparse non-negative matrix factorisation\ngl.run.snmf(), gl.plot.snmf(), gl.map.snmf()\n\n\nPOPCLUSTER\nUltra-fast admixture inference\ngl.run.popcluster(), gl.plot.popcluster(), gl.map.popcluster()\n\n\n\n\n\n\nExample\nTo help us understand our analytical toolkit better let’s start with a simple example using a simulated dataset.\nThe dataset is a genlight object and contains 10 populations of 30 individuals each and 1000 loci and is part of the dartRverse package. The populations are fairly independent but are linked by some imigration, so a typical Metapopulation scenario. The populations are named A to J and follow more or less an isolation by distance (actually an isolation by resistance model). So population next to each other (e.g. B and C) are fairly well mixed and populations further apart from the rest (e.g. D) are more isolated.\nTo simplify this further we limit our exercise to the first 150 individuals only (which entails now 5 populations a 30 individuals, A to E). To get an overview on the population we use the function: gl.map.interactive which plots the individuals on a map. Please note the genlight/dartR object needs to have valid lat long coordinates for each individual to be able to do so.\nLets get started.\n\nPCA\n\n# Read in the simulated possum data\ngl &lt;- possums.gl[1:150,]\n# Interrogate to see what the data are\nnLoc(gl)\n\n[1] 200\n\nnInd(gl)\n\n[1] 150\n\ntable(pop(gl))\n\n\n A  B  C  D  E \n30 30 30 30 30 \n\n# SNP coding for individuals 1-5 and loci 1-8\nas.matrix(gl)[1:5, 1:8]\n\n  X1 X2 X3 X4 X5 X6 X7 X8\n1  1  2  1  2  2  2  1  2\n2  1  1  1  1  1  1  0  1\n3  2  0  2  0  1  1  1  1\n4  0  1  2  0  0  1  0  1\n5  1  2  1  2  2  2  1  0\n\n\nThe next step is to actually calculate genetic difference between individuals. We do this by measuring euclidean distance but it is worth remembering that there are a myriad of different distances we can use. There are five different options for the function we will using, gl.dist.ind, that may be worth exploring depending on the context of your data.\nThe distance measure for SNP genotypes can be one of:\n\nEuclidean Distance\nScaled Euclidean Distance\nSimple Mismatch Distance\nAbsolute Mismatch Distance\nCzekanowski (Manhattan) Distance\n\nBut lets stick with euclidean distance for now. Euclidean distance is quite simple it treats\npossum.gl\n\n# Calculate an Euclidean Distance Matrix on individuals\nD &lt;- gl.dist.ind(gl)\n\n\n\n\n\n\n\n# Represent visually as a heat map\ngl.plot.heatmap(D)\n\n\n\n\n\n\n\n\n\n# Undertake a PCA on the raw data\npc &lt;- gl.pcoa(gl, verbose = 3)\n\nStarting gl.pcoa \n  Processing genlight object with SNP data\n  Performing a PCA, individuals as entities, loci as attributes, SNP genotype as state\n\n\n\n\n\n\n\n\n\n  Ordination yielded 4 informative dimensions( broken-stick criterion) from 149 original dimensions\n    PCA Axis 1 explains 15.5 % of the total variance\n    PCA Axis 1 and 2 combined explain 30.8 % of the total variance\n    PCA Axis 1-3 combined explain 41.2 % of the total variance\nStarting gl.colors \nSelected color type 2 \nCompleted: gl.colors \n\n\n\n\n\n\n\n\n\nCompleted: gl.pcoa \n\n\n\n# Plot the first two dimensions of the PCA\npc_a1a2 &lt;- gl.pcoa.plot(pc,gl,pop.labels=\"legend\")\n\n\n\n\n\n\n\n# Plot the first and third dimensions of the PCA\npc_a1a3 &lt;- gl.pcoa.plot(pc,gl,xaxis=1,yaxis=3, pop.labels=\"legend\")\n\n\n\n\n\n\n\n\n\n\nSelect one cluster\n\n# Select only the data from one cluster in the primary PCA\ntemp &lt;- gl.drop.pop(gl, pop.list=c('D', 'A'))\n\nStarting gl.drop.pop \n  Processing genlight object with SNP data\n  Checking for presence of nominated populations, deleting them\n  Warning: Resultant dataset may contain monomorphic loci\n  Locus metrics not recalculated\nCompleted: gl.drop.pop \n\n# Plot the first two dimensions of the secondary PCA\npc &lt;- gl.pcoa(temp, verbose = 3)\n\nStarting gl.pcoa \n  Processing genlight object with SNP data\n  Performing a PCA, individuals as entities, loci as attributes, SNP genotype as state\n\n\n\n\n\n\n\n\n\n  Ordination yielded 2 informative dimensions( broken-stick criterion) from 89 original dimensions\n    PCA Axis 1 explains 22.9 % of the total variance\n    PCA Axis 1 and 2 combined explain 30.5 % of the total variance\n    PCA Axis 1-3 combined explain NA % of the total variance\nStarting gl.colors \nSelected color type 2 \nCompleted: gl.colors \n\n\n\n\n\n\n\n\n\nCompleted: gl.pcoa \n\npc_plot &lt;- gl.pcoa.plot(pc, temp,pop.labels=\"legend\")\n\nStarting gl.pcoa.plot \n  Processing an ordination file (glPca)\n  Processing genlight object with SNP data\n  Plotting populations identified by a legend\n  Preparing plot .... please wait\n\n\n\n\n\n\n\n\n\nCompleted: gl.pcoa.plot \n\n\n\n\n\nWhat can go wrong\nMissing data causes distortion, which can lead to misinterpretation.\ndartR, that uses the adgenet package for its pca, fills missing data with the global average.\nYou can choose alternative methods of filling in the missing data prior to running your pca using the gl.impute function.\nPCA is a hypothesis generating tool, not a tool for definitive decisions of the structure of populations.\nStructure variants can also turn up on a PCA, like an inversion.\nPCA is sample size dependent - but this is more for the top two dimensions not all the informative dimensions.\n\n\nStructure and FastStructure\nTo run STRUCTURE from within R, we need to install the non-GUI executable (the version without frontend) for your operating system [e.g windows, mac or linux]. You can download STRUCTURE for your OS from http://web.stanford.edu/group/pritchardlab/structure_software/release_versions/v2.3.4/html/structure.html.\nTo let R know where the executable is, you need to set the path to the executable. For example, under windows, if you have the executable in d:/programms/structure/structure.exe, you can use the command below.\n\n\nRunning STRUCTURE\n\nsrnoad &lt;- gl.run.structure(possums, k.range = 2:7, num.k.rep = 10, exec =\n                             './binaries/structure.exe',plot.out = FALSE,\n                           burnin=50, numreps=100, # this is just for a test run\n                         # burnin=50000, numreps=100000, # for robust results\n                           noadmix=FALSE)\n\nev &lt;- gl.evanno(srnoad)\n\nqmatnoad &lt;- gl.plot.structure(srnoad2, K=4, clumpak = TRUE)\n\n\ngm &lt;- gl.map.structure(qmat = qmatnoad, x = possums, K=3, scalex=1, scaley=0.5 )\n\n\n\n\n\n\n\nExercise: Study the results using different Ks and with/without admixture\n\n\n\n The above run was a structure run using the no-admixture model for a range of K=2:7. Study the results by plotting it for various Ks and try to interpret the results in the light of the simulated population structure.\nHow about trying it on your own data or the example data provided.\n\n\n\n\nsnmf\n\n\nPopclusture",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Identifying Population Structure</span>"
    ]
  },
  {
    "objectID": "session03.html#exercise",
    "href": "session03.html#exercise",
    "title": "3  Identifying Population Structure",
    "section": "Exercise",
    "text": "Exercise\nFun example on real data.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Identifying Population Structure</span>"
    ]
  },
  {
    "objectID": "session03.html#further-study",
    "href": "session03.html#further-study",
    "title": "3  Identifying Population Structure",
    "section": "Further Study",
    "text": "Further Study\nPdfs/links\n\nReadings\n• Evanno et al. 2005 – Detecting the number of clusters (ΔK).\n• Lawson et al. 2018 – How not to over-interpret STRUCTURE/ADMIXTURE plots.\n• Wang 2017 – Common pitfalls when using STRUCTURE.\n• Raj et al. 2014 – fastSTRUCTURE.\n• Frichot et al. 2014 – sNMF.\n• Wang 2022 – POPCLUSTER.\n• Kopelman et al. 2015 – CLUMPAK.\n• Jakobsson & Rosenberg 2007 – CLUMPP.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Identifying Population Structure</span>"
    ]
  },
  {
    "objectID": "session04.html",
    "href": "session04.html",
    "title": "4  Kinship, Pedigrees & Mating Recommendations",
    "section": "",
    "text": "Required packages\nSession Presenters\nlibrary(dartR.base)\nlibrary(dartR.data)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Kinship, Pedigrees & Mating Recommendations</span>"
    ]
  },
  {
    "objectID": "session04.html#session-content",
    "href": "session04.html#session-content",
    "title": "4  Kinship, Pedigrees & Mating Recommendations",
    "section": "Session Content",
    "text": "Session Content",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Kinship, Pedigrees & Mating Recommendations</span>"
    ]
  },
  {
    "objectID": "session04.html#further-study",
    "href": "session04.html#further-study",
    "title": "4  Kinship, Pedigrees & Mating Recommendations",
    "section": "Further Study",
    "text": "Further Study\n\nReadings",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Kinship, Pedigrees & Mating Recommendations</span>"
    ]
  },
  {
    "objectID": "session05.html",
    "href": "session05.html",
    "title": "5  Assigning Individuals to Populations",
    "section": "",
    "text": "Required packages\nSession Presenter\nlibrary(dartRverse)",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Assigning Individuals to Populations</span>"
    ]
  },
  {
    "objectID": "session05.html#session-content",
    "href": "session05.html#session-content",
    "title": "5  Assigning Individuals to Populations",
    "section": "Session Content",
    "text": "Session Content\nThis is a workflow associated with Session on Population Assignment in the dartR workshop\n\n# We will first set the verbosity globally to level 3\ngl.set.verbosity(3)\n\nStarting gl.set.verbosity \n  Global verbosity set to: 3 \nCompleted: gl.set.verbosity \n\n\n\n# Read in the data set for the worked example\ngl &lt;- readRDS(\"./data/assignment_example1.Rdata\")\n# Familiarize yourself with its contents\ngl  \n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 835 genotypes,  20,688 SNPs , size: 57.3 Mb\n\n    missing data: 289548 (=1.68 %) scored as NA\n\n ** Genetic data\n   @gen: list of 835 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  835 individual labels\n   @loc.names:  20688 locus labels\n   @loc.all:  20688 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 3-30)\n   @other: a list containing: loc.metrics, ind.metrics, latlon, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, lat, lon, sex, maturity, collector, location, basin, drainage, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC, TrimmedSequence \n   @other$latlon[g]: coordinates for all individuals are attached\n\nnLoc(gl)\n\n[1] 20688\n\nnInd(gl)\n\n[1] 835\n\nnPop(gl)\n\n[1] 81\n\n# Display a list of populations and sample sizes\ntable(pop(gl))\n\n\n         Brisbane          Burdekin           Burnett          Clarence \n               10                10                11                10 \n     Cooper_Alvin      Cooper_Cully  Cooper_Eulbertie        Dumaresque \n               10                10                10                10 \nFitzroy_Alligator  Fitzroy_Carnavan  Fitzroy_Fairburn     Fraser_Island \n               10                10                10                10 \n           Hunter     EmmacJohnWari     EmmacMaclGeor              Mary \n               10                10                11                10 \n     EmmacMDBBarr      EmmacMDBBarw     EmmacMDBBooth      EmmacMDBBowm \n               10                10                 9                10 \n     EmmacMDBBurr      EmmacMDBCond      EmmacMDBCudg  EmmacMDBDarlBour \n               10                10                10                10 \n EmmacMDBDarlWeth      EmmacMDBDart      EmmacMDBEulo      EmmacMDBForb \n               10                10                10                10 \n     EmmacMDBGoul        GurraGurra      EmmacMDBGwyd      EmmacMDBLach \n               10                10                10                10 \n     EmmacMDBLodd      EmmacMDBMaci      EmmacMDBMoon  EmmacMDBMurrGunb \n               10                10                10                10 \n EmmacMDBMurrLock  EmmacMDBMurrMorg  EmmacMDBMurrMung  EmmacMDBMurrMurr \n               10                10                10                10 \n EmmacMDBMurrTink EmmacMDBMurrYarra      EmmacMDBOven  EmmacMDBParoBiny \n               10                10                10                10 \n     EmmacMDBPind      EmmacMDBSanf      EmmacMDBToon          Normanby \n               10                10                11                11 \n             Pine     EmmacRichCasi         EmmacRoss      EmmacTweeUki \n               10                10                10                10 \n     EmsubBamuAli     EmsubBamuAwab     EmsubMorehead      EmsubFlyGuka \n               10                 9                16                10 \n     EmsubFlyJikw      EmsubJardine       EmsubKerema       EmsubKikori \n               30                16                10                 4 \n       EmworRoper        EmtanBlyth      EmtanFinniss     EmtanHolrChai \n               11                10                 7                10 \n    EmtanMitchell     EmtanMitcMitc     EmtanPascFarm      EmtanWenlock \n                9                 3                 9                10 \n        EmvicDaly     EmvicDrysdale        Fitzroy_WA     EmvicIsdeBell \n               10                10                10                12 \n    EmvicKingMool          EmvicOrd     EmworClavPung         EmworDaly \n               10                18                10                10 \n    EmworDalySlei     EmworLeicAlex     EmworLimmNath     EmworLiveMann \n                7                10                10                 9 \n    EmworNichGreg \n               12 \n\n\n\n\n\n\n\n\nNote that several populations have sample sizes less than 10 and will be discarded during the analysis\n\n\n\n\n\n\n\nAnalysis 1: Assignment by genotype likelihood\n\n#gen.result&lt;-gl.assign.on.genotype(gl, unknown=\"AA011731\", nmin=10)\n\n\n\nAnalysis 2: Assignment by Private Alleles\n\n# pa.result &lt;- gl.assign.pa(gl, unknown=\"AA011731\", nmin=10, alpha=0.05)\npa.result &lt;- gl.assign.pa(gl, unknown=\"AA011731\", nmin=10)\n\nStarting gl.assign.pa \n  Processing genlight object with SNP data\n  Discarding 9 populations with sample size &lt; 10 :\nEmmacMDBBooth, EmsubBamuAwab, EmsubKikori, EmtanFinniss, EmtanMitchell, EmtanMitcMitc, EmtanPascFarm, EmworDalySlei, EmworLiveMann \n  Assigning 1 unknown individual AA011731 to 72 target populations using 20396 loci\n  Table showing populations against number of loci with private\n            alleles\n  &gt;0 ---   88 Burnett \n  &gt;0 ---   97 Mary \n  &gt;0 ---   204 Pine \n  &gt;0 ---   394 Fitzroy_Alligator \n  &gt;0 ---   398 Fitzroy_Fairburn \n  &gt;0 ---   440 Fitzroy_Carnavan \n  &gt;0 ---   644 Fraser_Island \n  &gt;0 ---   695 EmmacMDBEulo \n  &gt;0 ---   719 Brisbane \n  &gt;0 ---   728 EmmacMDBToon \n  &gt;0 ---   733 EmmacTweeUki \n  &gt;0 ---   891 EmmacMDBCond \n  &gt;0 ---   963 EmmacRichCasi \n  &gt;0 ---   985 EmmacMDBDarlWeth \n  &gt;0 ---   1040 EmmacMDBMurrGunb \n  &gt;0 ---   1059 EmmacMDBMurrTink \n  &gt;0 ---   1067 Dumaresque \n  &gt;0 ---   1075 EmmacMDBDarlBour \n  &gt;0 ---   1076 EmmacMDBMaci \n  &gt;0 ---   1077 EmmacMDBMurrMorg \n  &gt;0 ---   1080 EmmacMDBGoul \n  &gt;0 ---   1090 EmmacMDBMoon \n  &gt;0 ---   1091 EmmacMDBBarw \n  &gt;0 ---   1093 EmmacMDBGwyd \n  &gt;0 ---   1097 EmmacMDBMurrMung \n  &gt;0 ---   1098 EmmacMDBBarr \n  &gt;0 ---   1111 EmmacMDBMurrMurr \n  &gt;0 ---   1112 EmmacMDBMurrLock \n  &gt;0 ---   1113 EmmacMDBCudg EmmacMDBOven GurraGurra \n  &gt;0 ---   1114 EmmacMDBLodd \n  &gt;0 ---   1116 EmmacMDBMurrYarra \n  &gt;0 ---   1142 EmmacMDBParoBiny \n  &gt;0 ---   1168 EmmacMDBBowm \n  &gt;0 ---   1171 EmmacMDBSanf \n  &gt;0 ---   1228 EmmacMDBBurr \n  &gt;0 ---   1243 EmmacMDBPind \n  &gt;0 ---   1245 EmmacMDBLach \n  &gt;0 ---   1253 EmmacMDBForb \n  &gt;0 ---   1278 EmmacMDBDart \n  &gt;0 ---   1290 Clarence \n  &gt;0 ---   1303 Burdekin \n  &gt;0 ---   1357 EmmacRoss \n  &gt;0 ---   1445 EmmacJohnWari \n  &gt;0 ---   1610 EmmacMaclGeor \n  &gt;0 ---   1779 Cooper_Alvin \n  &gt;0 ---   1797 Cooper_Cully \n  &gt;0 ---   1800 Cooper_Eulbertie \n  &gt;0 ---   1847 Normanby \n  &gt;0 ---   2699 Hunter \n  &gt;0 ---   3206 EmsubFlyJikw \n  &gt;0 ---   3332 EmsubMorehead \n  &gt;0 ---   3448 EmsubFlyGuka \n  &gt;0 ---   3468 EmworRoper \n  &gt;0 ---   3477 EmworNichGreg \n  &gt;0 ---   3511 EmsubBamuAli \n  &gt;0 ---   3522 EmvicDaly \n  &gt;0 ---   3594 EmsubJardine \n  &gt;0 ---   3665 EmworClavPung \n  &gt;0 ---   3758 EmworDaly \n  &gt;0 ---   3871 EmworLeicAlex \n  &gt;0 ---   3872 EmworLimmNath \n  &gt;0 ---   3947 EmvicOrd \n  &gt;0 ---   4091 EmvicIsdeBell \n  &gt;0 ---   4147 Fitzroy_WA \n  &gt;0 ---   4155 EmvicKingMool \n  &gt;0 ---   4165 EmsubKerema \n  &gt;0 ---   4201 EmvicDrysdale \n  &gt;0 ---   4262 EmtanWenlock \n  &gt;0 ---   4288 EmtanHolrChai \n  &gt;0 ---   4444 EmtanBlyth \n  There are no populations retained for assignment.   The unknown may not belong to one of the target populations.   Returning genlight object for the unknown individual only\nCompleted: gl.assign.pa \n\n\n\n\nAnalysis 3: Assignment by PCA\n\n#pca_pa_result &lt;-gl.assign.pca(pa.result, unknown=\"AA011731\")\n\n\n\nAnalysis 4: Assignment by Mahalanobis Distances\n\n#mahal_result &lt;- gl.assign.mahalanobis(pa.result,unknown=\"AA011731\")",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Assigning Individuals to Populations</span>"
    ]
  },
  {
    "objectID": "session05.html#exercise",
    "href": "session05.html#exercise",
    "title": "5  Assigning Individuals to Populations",
    "section": "Exercise",
    "text": "Exercise\n\nThe data\n\ngl\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 835 genotypes,  20,688 SNPs , size: 57.3 Mb\n\n    missing data: 289548 (=1.68 %) scored as NA\n\n ** Genetic data\n   @gen: list of 835 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  835 individual labels\n   @loc.names:  20688 locus labels\n   @loc.all:  20688 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 3-30)\n   @other: a list containing: loc.metrics, ind.metrics, latlon, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, lat, lon, sex, maturity, collector, location, basin, drainage, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, monomorphs, maf, OneRatio, PIC, TrimmedSequence \n   @other$latlon[g]: coordinates for all individuals are attached\n\n# The unknown\nUnknown = \"AA046092\"\n# Preliminaries\npopNames(gl)\n\n [1] \"Brisbane\"          \"Burdekin\"          \"Burnett\"          \n [4] \"Clarence\"          \"Cooper_Alvin\"      \"Cooper_Cully\"     \n [7] \"Cooper_Eulbertie\"  \"Dumaresque\"        \"Fitzroy_Alligator\"\n[10] \"Fitzroy_Carnavan\"  \"Fitzroy_Fairburn\"  \"Fraser_Island\"    \n[13] \"Hunter\"            \"EmmacJohnWari\"     \"EmmacMaclGeor\"    \n[16] \"Mary\"              \"EmmacMDBBarr\"      \"EmmacMDBBarw\"     \n[19] \"EmmacMDBBooth\"     \"EmmacMDBBowm\"      \"EmmacMDBBurr\"     \n[22] \"EmmacMDBCond\"      \"EmmacMDBCudg\"      \"EmmacMDBDarlBour\" \n[25] \"EmmacMDBDarlWeth\"  \"EmmacMDBDart\"      \"EmmacMDBEulo\"     \n[28] \"EmmacMDBForb\"      \"EmmacMDBGoul\"      \"GurraGurra\"       \n[31] \"EmmacMDBGwyd\"      \"EmmacMDBLach\"      \"EmmacMDBLodd\"     \n[34] \"EmmacMDBMaci\"      \"EmmacMDBMoon\"      \"EmmacMDBMurrGunb\" \n[37] \"EmmacMDBMurrLock\"  \"EmmacMDBMurrMorg\"  \"EmmacMDBMurrMung\" \n[40] \"EmmacMDBMurrMurr\"  \"EmmacMDBMurrTink\"  \"EmmacMDBMurrYarra\"\n[43] \"EmmacMDBOven\"      \"EmmacMDBParoBiny\"  \"EmmacMDBPind\"     \n[46] \"EmmacMDBSanf\"      \"EmmacMDBToon\"      \"Normanby\"         \n[49] \"Pine\"              \"EmmacRichCasi\"     \"EmmacRoss\"        \n[52] \"EmmacTweeUki\"      \"EmsubBamuAli\"      \"EmsubBamuAwab\"    \n[55] \"EmsubMorehead\"     \"EmsubFlyGuka\"      \"EmsubFlyJikw\"     \n[58] \"EmsubJardine\"      \"EmsubKerema\"       \"EmsubKikori\"      \n[61] \"EmworRoper\"        \"EmtanBlyth\"        \"EmtanFinniss\"     \n[64] \"EmtanHolrChai\"     \"EmtanMitchell\"     \"EmtanMitcMitc\"    \n[67] \"EmtanPascFarm\"     \"EmtanWenlock\"      \"EmvicDaly\"        \n[70] \"EmvicDrysdale\"     \"Fitzroy_WA\"        \"EmvicIsdeBell\"    \n[73] \"EmvicKingMool\"     \"EmvicOrd\"          \"EmworClavPung\"    \n[76] \"EmworDaly\"         \"EmworDalySlei\"     \"EmworLeicAlex\"    \n[79] \"EmworLimmNath\"     \"EmworLiveMann\"     \"EmworNichGreg\"    \n\ngl2 &lt;- gl.keep.pop(gl, pop.list=c(\"EmsubBamuAli\", \"EmsubFlyGuka\", \"EmsubFlyJikw\",\n                                  \"EmsubJardine\", \"EmsubKerema\", \"EmsubMorehead\"))\n\nStarting gl.keep.pop \n  Processing genlight object with SNP data\n  Checking for presence of nominated populations\n  Retaining only populations EmsubBamuAli, EmsubFlyGuka, EmsubFlyJikw, EmsubJardine, EmsubKerema, EmsubMorehead \n  Locus metrics not recalculated\n  Summary of recoded dataset\n  Original no. of populations 81 \n     No. of populations deleted: 75 \n  Final No. of Populations: 6 \n  Original No. of loci: 20688 \n    Deleted monomorphic loci arising (if mono.rm=TRUE): 0 \n  Final No. of Loci: 20688 \n  Original No. of individuals: 835 \n    Deleted: 743 \n  Final No. of individuals: 92 \nCompleted: gl.keep.pop \n\n# Knock yourself out",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Assigning Individuals to Populations</span>"
    ]
  },
  {
    "objectID": "session05.html#further-study",
    "href": "session05.html#further-study",
    "title": "5  Assigning Individuals to Populations",
    "section": "Further Study",
    "text": "Further Study\n\nReadings",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Assigning Individuals to Populations</span>"
    ]
  },
  {
    "objectID": "session06.html",
    "href": "session06.html",
    "title": "6  SNP Panel Selection & Simulations for Conservation",
    "section": "",
    "text": "Required packages\nSession Presenters\nlibrary(dartR.base)\nlibrary(dartR.data)",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>SNP Panel Selection & Simulations for Conservation</span>"
    ]
  },
  {
    "objectID": "session06.html#session-content",
    "href": "session06.html#session-content",
    "title": "6  SNP Panel Selection & Simulations for Conservation",
    "section": "Session Content",
    "text": "Session Content",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>SNP Panel Selection & Simulations for Conservation</span>"
    ]
  },
  {
    "objectID": "session06.html#further-study",
    "href": "session06.html#further-study",
    "title": "6  SNP Panel Selection & Simulations for Conservation",
    "section": "Further Study",
    "text": "Further Study\n\nReadings",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>SNP Panel Selection & Simulations for Conservation</span>"
    ]
  },
  {
    "objectID": "session07.html",
    "href": "session07.html",
    "title": "7  Simulations for Conservation",
    "section": "",
    "text": "Required packages\nSession Presenters\nlibrary(dartR.base)\nlibrary(dartR.data)",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Simulations for Conservation</span>"
    ]
  },
  {
    "objectID": "session07.html#session-content",
    "href": "session07.html#session-content",
    "title": "7  Simulations for Conservation",
    "section": "Session Content",
    "text": "Session Content",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Simulations for Conservation</span>"
    ]
  },
  {
    "objectID": "session07.html#further-study",
    "href": "session07.html#further-study",
    "title": "7  Simulations for Conservation",
    "section": "Further Study",
    "text": "Further Study\n\nReadings",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Simulations for Conservation</span>"
    ]
  },
  {
    "objectID": "session08.html",
    "href": "session08.html",
    "title": "8  Bonus! Sex Linked Markers",
    "section": "",
    "text": "Required packages\nSession Presenters\nlibrary(dartRverse)\nlibrary(dartR.sexlinked)",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bonus! Sex Linked Markers</span>"
    ]
  },
  {
    "objectID": "session08.html#session-content",
    "href": "session08.html#session-content",
    "title": "8  Bonus! Sex Linked Markers",
    "section": "Session Content",
    "text": "Session Content",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bonus! Sex Linked Markers</span>"
    ]
  },
  {
    "objectID": "session08.html#session-content-1",
    "href": "session08.html#session-content-1",
    "title": "8  Bonus! Sex Linked Markers",
    "section": "Session Content",
    "text": "Session Content\nIn this tutorial you will read about sex-linked loci and do two excercises.\n\nIntroduction\nExercises\n\nExercise 1: Identifying sex-linked loci and using them for sexing\nExercise 2: Observing the effects of not removing sex-linked loci on population genetic analyses\n\n2.1. Differences in PCoA\n2.2. Differences in genetic diversity and fixation indices\n\n\nReferences",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bonus! Sex Linked Markers</span>"
    ]
  },
  {
    "objectID": "session08.html#introduction",
    "href": "session08.html#introduction",
    "title": "8  Bonus! Sex Linked Markers",
    "section": "Introduction",
    "text": "Introduction\nMany population genetic studies assume autosomal loci. Therefore, it is best practice to exclude sex-linked loci from SNP datasets. Failing to remove these loci can lead to skewed estimates of genetic diversity—such as heterozygosity, fixation indices (like FIS), polymorphism, and allelic richness—especially when the sample has an uneven sex ratio or when there are differences in diversity between sex chromosomes and autosomes. Identifying population structure also improves when sex-linked loci are excluded, since these markers can obscure patterns shaped by evolutionary forces like gene flow, selection, and drift. Similarly, parentage analyses, which rely on autosomal Mendelian inheritance, can be compromised by sex-linked loci, leading to apparent mismatches between true parent-offspring pairs. Therefore, accurately identifying sex-linked loci is essential for reliable genetic analysis and informed management decisions.\nOn the other hand, identifying sex-linked markers can be valuable for determining the sex of individuals in species without sexual dimorphism, and for uncovering sex-specific ecological or evolutionary patterns.\nSex-linked markers are those that are inherited differently between the sexes, usually because they are present in sex chromosomes. In animal species, the two most common chromosomal sex-determination systems are ZW and XY. In the ZW system, typical for birds and some reptiles and insects, females are heterogametic (ZW) and males are homogametic (ZZ). On the contrary, in an XY system, typical for mammals and some insects, males are the heterogametic sex with one X and one Y chromosome, and females are the homogametic sex with two X chromosomes.\nSex-linked markers can be classified into three types (Figure 1):\n\nW-linked or Y-linked loci\nZ-linked or X-linked loci\nGametologs\n\n\n\n\nFigure 1. Sex-linked markers in ZW sex-determination systems",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bonus! Sex Linked Markers</span>"
    ]
  },
  {
    "objectID": "session08.html#exercises",
    "href": "session08.html#exercises",
    "title": "8  Bonus! Sex Linked Markers",
    "section": "Exercises",
    "text": "Exercises\nThe following exercises can be done with the dataset included in the dartR.sexlinked package (that of the beautiful Eastern Yellow Robin, EYR; Figure 2; Robledo-Ruiz et al. 2023) or on your own data!\n\n\n\nFigure 2. Eastern Yellow Robin. Isn’t it a cutie?",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bonus! Sex Linked Markers</span>"
    ]
  },
  {
    "objectID": "session08.html#exercise-1-identify-sex-linked-loci-and-use-them-for-sexing",
    "href": "session08.html#exercise-1-identify-sex-linked-loci-and-use-them-for-sexing",
    "title": "8  Bonus! Sex Linked Markers",
    "section": "Exercise 1: Identify sex-linked loci and use them for sexing ",
    "text": "Exercise 1: Identify sex-linked loci and use them for sexing \nImagine you have a genetic dataset in which you have the sexes of most individuals but not all. You are also not sure about the sexes you have recorded for some individuals during fieldwork (human error exists!). Because you know a lot about sex-linked loci, you want to see if you can identify some in order to help you double-check sexes.\n\nLoad data\nStart by calling the dataset and exploring it.\n\ndata(\"EYR\")\nEYR                   # Explore the dataset\n\n ********************\n *** DARTR OBJECT ***\n ********************\n\n ** 782 genotypes,  1,000 SNPs , size: 20.2 Mb\n\n    missing data: 147031 (=18.8 %) scored as NA\n\n ** Genetic data\n   @gen: list of 782 SNPbin\n   @ploidy: ploidy of each individual  (range: 2-2)\n\n ** Additional data\n   @ind.names:  782 individual labels\n   @loc.names:  1000 locus labels\n   @loc.all:  1000 allele labels\n   @position: integer storing positions of the SNPs [within 69 base sequence]\n   @pop: population of each individual (group size range: 52-421)\n   @other: a list containing: loc.metrics, ind.metrics, loc.metrics.flags, verbose, history \n    @other$ind.metrics: id, pop, sex, Mito, service, plate_location \n    @other$loc.metrics: AlleleID, CloneID, AlleleSequence, TrimmedSequence, Chrom_Yellow_robin_HiC_v2, ChromPos_Yellow_robin_HiC_v2, AlnCnt_Yellow_robin_HiC_v2, AlnEvalue_Yellow_robin_HiC_v2, SNP, SnpPosition, CallRate, OneRatioRef, OneRatioSnp, FreqHomRef, FreqHomSnp, FreqHets, PICRef, PICSnp, AvgPIC, AvgCountRef, AvgCountSnp, RepAvg, clone, uid, rdepth, maf \n   @other$latlon[g]: no coordinates attached\n\nEYR@n.loc             # Number of SNPs\n\n[1] 1000\n\nlength(EYR@ind.names) # Number of individuals\n\n[1] 782\n\n\n\n\nSearch for sex-linked loci\nThe function gl.report.sexlinked identifies sex-linked and autosomal loci present in a SNP dataset (genlight object) using individuals with known sex. It identifies five types of loci: w-linked or y-linked, sex-biased, z-linked or x-linked, gametologous and autosomal.\n\n\n\n\n\n\nNote\n\n\n\nThe genlight object must contain in gl@other$ind.metrics a column named id, and a column named sex in which individuals with known-sex are assigned M for male, or F for female. The function ignores individuals that are assigned anything else or nothing at all (unknown-sex).\n\n\nCheck that ind.metrics has the necessary columns:\n\nknitr::kable(EYR@other$ind.metrics[1:10,])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nid\npop\nsex\nMito\nservice\nplate_location\n\n\n\n\n024-96401\n024-96401\nCrusoe\nM\nB\nDYro17-3039\n2-D9\n\n\n024-96401b\n024-96401b\nCrusoe\nM\nB\nDYro21-6107\n3-D3\n\n\n024-96402\n024-96402\nCrusoe\nF\nA\nDYro17-3039\n2-C9\n\n\n024-96403\n024-96403\nCrusoe\nM\nB\nDYro17-3039\n2-B9\n\n\n024-96404\n024-96404\nCrusoe\nM\nA\nDYro17-3039\n2-A9\n\n\n024-96405\n024-96405\nMuckleford\nM\nA\nDYro17-3039\n2-D6\n\n\n024-96406\n024-96406\nCrusoe\nF\nA\nDYro17-3039\n2-H8\n\n\n024-96407\n024-96407\nCrusoe\nF\nA\nDYro17-3039\n2-G8\n\n\n024-96408\n024-96408\nCrusoe\nM\nA\nDYro17-3039\n2-F8\n\n\n024-96410\n024-96410\nMuckleford\nM\nA\nDYro17-3039\n1-E9\n\n\n\n\n\nonly showing first 10 rows\nRun the function to identify sex-linked loci in the EYR genlight object:\n\nout &lt;- gl.report.sexlinked(EYR, system = \"zw\")\n\nStarting gl.report.sexlinked \n  Processing genlight object with SNP data\n\n\nDetected 352 females and 429 males.\n\n\nStarting phase 1. May take a while...\n\n\nBuilding call rate plot.\n\n\nDone building call rate plot.\n\n\nStarting phase 2. May take a while...\n\n\nBuilding heterozygosity plot.\n\n\nDone building heterozygosity plot.\n\n\n**FINISHED** Total of analyzed loci: 1000.\nFound 150 sex-linked loci:\n   16 W-linked loci\n   82 sex-biased loci\n   32 Z-linked loci\n   20 gametologs.\nAnd 850 autosomal loci.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCompleted: gl.report.sexlinked \n\n\n\n\n\n\n\n\nNote\n\n\n\nQuestion: How many males and females does the dataset contain?\nQuestion: How many sex-linked loci were found?\nQuestion: Why are there two plots?\nQuestion: What does each point in the plots represent?\nQuestion: What do the colours in the plots mean? Look at Figure 1 for a hint. What about the blue dots?\n\n\n\n\nSexing individuals with unknown sex\nThe dartR.sexlinked package has more functions that can be useful when a dataset has some missing sex data.\n\n\n\n\n\n\nNote\n\n\n\nQuestion: How many individuals does the EYR genlight object contain?\nQuestion: How many males and females were detected by function gl.report.sexlinked? Are there individuals with unknown sex?\n\n\nFind the id of the individual that is not sexed:\n\nEYR@other$ind.metrics[!(EYR@other$ind.metrics$sex %in% c(\"M\", \"F\")), ]\n\n                 id        pop sex Mito     service plate_location\n024-96417 024-96417 Muckleford        B DYro17-3039           2-E5\n\n\nUse the sex-linked loci you have identified to infer the sex of that individual by running function infer.sex.\nThis function uses the output of function gl.keep.sexlinked to infer the sex of all individuals in the dataset. It uses 3 types of sex-linked loci (W-/Y-linked, Z-/X-linked, and gametologs), assigns a preliminary genetic sex for each type of sex-linked loci available, and outputs an agreed sex:\n\nEYR_sexLinked &lt;- gl.keep.sexlinked(EYR, system = \"zw\") # save sex-linked loci\n\nStarting gl.keep.sexlinked \n  Processing genlight object with SNP data\n\n\nDetected 352 females and 429 males.\n\n\nStarting phase 1. May take a while...\n\n\nBuilding call rate plots.\n\n\nStarting phase 2. May take a while...\n\n\nBuilding heterozygosity plots.\n\n\nDone building heterozygosity plots.\n\n\n**FINISHED** Total of analyzed loci: 1000.\nKept 150 sex-linked loci:\n   16 W-linked loci\n   82 sex-biased loci\n   32 Z-linked loci\n   20 gametologs.\nAnd removed 850 autosomal loci.\n\n\n\n\n\n\n\n\n\nCompleted: gl.keep.sexlinked \n\n#inferred.sexes &lt;- gl.infer.sex(gl_sexlinked = EYR_sexLinked, system = \"zw\", seed = 124) # use sex-linked loci\n\nThe function outputs a table with assigned sexes based on sex-linked loci:\n\n#View(inferred.sexes)\n\nExamine the output table. There are four assigned sexes per individual: one according to w-linked loci, one according to z-linked loci, one according to gametologs, and one final agreed sex.\n\n\n\n\n\n\nNote\n\n\n\nQuestion: What agreed sex was assigned to the individual with missing sex?\nQuestion: Can you find individuals for which the agreed sex is uncertain (i.e., has an asterisk ‘*’)? How would you decide which is their correct sex?",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bonus! Sex Linked Markers</span>"
    ]
  },
  {
    "objectID": "session08.html#exercise-2-observe-the-effects-of-not-removing-sex-linked-loci-on-population-genetic-analyses",
    "href": "session08.html#exercise-2-observe-the-effects-of-not-removing-sex-linked-loci-on-population-genetic-analyses",
    "title": "8  Bonus! Sex Linked Markers",
    "section": "Exercise 2: Observe the effects of not removing sex-linked loci on population genetic analyses ",
    "text": "Exercise 2: Observe the effects of not removing sex-linked loci on population genetic analyses \nImagine you are analyzing the genetic data of a species and you want to look at its population structure and genetic diversity. You start by filtering your beautiful set of SNPs. Because you are a rigorous scientist, you want to test whether using function gl.drop.sexlinked to properly filter out sex-linked loci changes the results of the populations analyses. So you: (1) process your SNP dataset by applying only standard filters (from here on “sloppy filtering”) and run analyses, and (2) process the dataset by filtering out sex-linked loci first, applying standard filters second (from here on “correct filtering”), and then run analyses.\nUse the EYR dataset or your own data to report:\n\nDo you see any changes in a population structure analysis (PCoA) when you filter out sex-linked markers versus when you do not?\nDo you see any differences in genetic diversity and fixation indices when you filter out sex-linked markers versus when you do not?\n\n\nFiltering SNPs only with standard filters (“sloppy filtering”)\nLet’s apply only standard filters (read depth, call rate, and MAC):\n\n# Filter for read depth\ngl.report.rdepth(EYR)\n\nStarting gl.report.rdepth \n  Processing genlight object with SNP data\n  Reporting Read Depth by Locus\n  No. of loci = 1000 \n  No. of individuals = 782 \n    Minimum      :  2.6 \n    1st quartile :  4.3 \n    Median       :  5.6 \n    Mean         :  5.9649 \n    3r quartile  :  7.325 \n    Maximum      :  13.2 \n    Missing Rate Overall:  0.19 \n\n\n\n\n\n\n\n\n\n   Quantile Threshold Retained Percent Filtered Percent\n1      100%      13.2        1     0.1      999    99.9\n2       95%       9.9       51     5.1      949    94.9\n3       90%       9.0      105    10.5      895    89.5\n4       85%       8.3      151    15.1      849    84.9\n5       80%       7.8      208    20.8      792    79.2\n6       75%       7.3      258    25.8      742    74.2\n7       70%       6.9      304    30.4      696    69.6\n8       65%       6.5      354    35.4      646    64.6\n9       60%       6.2      404    40.4      596    59.6\n10      55%       5.9      451    45.1      549    54.9\n11      50%       5.6      504    50.4      496    49.6\n12      45%       5.3      563    56.3      437    43.7\n13      40%       5.1      602    60.2      398    39.8\n14      35%       4.8      659    65.9      341    34.1\n15      30%       4.6      702    70.2      298    29.8\n16      25%       4.3      752    75.2      248    24.8\n17      20%       4.0      823    82.3      177    17.7\n18      15%       3.9      852    85.2      148    14.8\n19      10%       3.6      906    90.6       94     9.4\n20       5%       3.3      956    95.6       44     4.4\n21       0%       2.6     1000   100.0        0     0.0\nCompleted: gl.report.rdepth \n\nEYR.sloppy &lt;- gl.filter.rdepth(EYR, lower = 3, upper = 11, verbose = 0)\n\n\n\n\n\n\n\n# Filter for loci call rate\ngl.report.callrate(EYR.sloppy, method = \"loc\")\n\nStarting gl.report.callrate \n  Processing genlight object with SNP data\n  Reporting Call Rate by Locus\n  No. of loci = 958 \n  No. of individuals = 782 \n    Minimum      :  0.20844 \n    1st quartile :  0.7202688 \n    Median       :  0.895141 \n    Mean         :  0.8131871 \n    3r quartile  :  0.950128 \n    Maximum      :  0.988491 \n    Missing Rate Overall:  0.1868 \n\n   Quantile Threshold Retained Percent Filtered Percent\n1      100%  0.988491        1     0.1      957    99.9\n2       95%  0.979540       52     5.4      906    94.6\n3       90%  0.973146      104    10.9      854    89.1\n4       85%  0.965473      145    15.1      813    84.9\n5       80%  0.956522      197    20.6      761    79.4\n6       75%  0.950128      247    25.8      711    74.2\n7       70%  0.943734      291    30.4      667    69.6\n8       65%  0.932225      339    35.4      619    64.6\n9       60%  0.921995      386    40.3      572    59.7\n10      55%  0.910486      434    45.3      524    54.7\n11      50%  0.895141      482    50.3      476    49.7\n12      45%  0.872123      527    55.0      431    45.0\n13      40%  0.847826      575    60.0      383    40.0\n14      35%  0.819693      623    65.0      335    35.0\n15      30%  0.780051      671    70.0      287    30.0\n16      25%  0.719949      719    75.1      239    24.9\n17      20%  0.662404      768    80.2      190    19.8\n18      15%  0.594629      815    85.1      143    14.9\n19      10%  0.523018      863    90.1       95     9.9\n20       5%  0.402813      911    95.1       47     4.9\n21       0%  0.208440      958   100.0        0     0.0\n\n\n\n\n\n\n\n\n\nCompleted: gl.report.callrate \n\nEYR.sloppy &lt;- gl.filter.callrate(EYR.sloppy, method = \"loc\",  threshold = 0.75, verbose = 0, recalc = TRUE)\n\n# Filter for individual call rate\ngl.report.callrate(EYR.sloppy, method = \"ind\")\n\nStarting gl.report.callrate \n  Processing genlight object with SNP data\n\n  Reporting Call Rate by Individual\n  No. of loci = 703 \n  No. of individuals = 782 \n    Minimum      :  0.03556188 \n    1st quartile :  0.9174964 \n    Median       :  0.9416785 \n    Mean         :  0.9108097 \n    3r quartile  :  0.9573257 \n    Maximum      :  0.9829303 \n    Missing Rate Overall:  0.0892 \n\nListing 4 populations and their average CallRates\n  Monitor again after filtering\n  Population CallRate   N\n1     Crusoe   0.9027 238\n2 Muckleford   0.9073 421\n3      Timor   0.9402  52\n4     Wombat   0.9371  71\n\nListing 20 individuals with the lowest CallRates\n  Use this list to see which individuals will be lost on filtering by individual\n  Set ind.to.list parameter to see more individuals\n   Individual Population   CallRate\n1    M18.29.1 Muckleford 0.03556188\n2    M18.18.1 Muckleford 0.03982930\n3    M18.47.2 Muckleford 0.06970128\n4    C18.16.1     Crusoe 0.07112376\n5   027-34168     Crusoe 0.07681366\n6    C18.15.2     Crusoe 0.08534851\n7    C18.21.2     Crusoe 0.08677098\n8    M18.47.3 Muckleford 0.14224751\n9    M18.35.2 Muckleford 0.17211949\n10   M18.20.3 Muckleford 0.24039829\n11   M20.70.2 Muckleford 0.39687055\n12   C18.28.1     Crusoe 0.39971550\n13   C18.17.2     Crusoe 0.46088193\n14  027-34065 Muckleford 0.50640114\n15   C18.14.1     Crusoe 0.50640114\n16   M20.70.3 Muckleford 0.50782361\n17  M20.110.1 Muckleford 0.52347084\n18   M19.12.1 Muckleford 0.53342817\n19    M19.8.1 Muckleford 0.54907539\n20   M20.64.3 Muckleford 0.56045519\n\n)\n\n\n\n\n\n\n\n\n\nCompleted: gl.report.callrate \n\nEYR.sloppy &lt;- gl.filter.callrate(EYR.sloppy, method = \"ind\", threshold = 0.65, verbose = 0, recalc = TRUE)\n# Filter for MAC (= 3)\ngl.report.maf(EYR.sloppy)\n\nStarting gl.report.maf \n  Processing genlight object with SNP data\nStarting gl.report.maf \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Crusoe \n  No. of loci = 670 \n  No. of individuals = 231 \n    Minimum      :  0.0022 \n    1st quantile :  0.064825 \n    Median       :  0.1582 \n    Mean         :  0.1793525 \n    3r quantile  :  0.267475 \n    Maximum      :  0.4975 \n    Missing Rate Overall:  0.08 \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Muckleford \n  No. of loci = 683 \n  No. of individuals = 401 \n    Minimum      :  0.0013 \n    1st quantile :  0.05875 \n    Median       :  0.1404 \n    Mean         :  0.1729489 \n    3r quantile  :  0.2617 \n    Maximum      :  0.4985 \n    Missing Rate Overall:  0.07 \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Timor \n  No. of loci = 589 \n  No. of individuals = 52 \n    Minimum      :  0.0096 \n    1st quantile :  0.0673 \n    Median       :  0.1667 \n    Mean         :  0.1914129 \n    3r quantile  :  0.2872 \n    Maximum      :  0.5 \n    Missing Rate Overall:  0.06 \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Wombat \n  No. of loci = 627 \n  No. of individuals = 71 \n    Minimum      :  0.007 \n    1st quantile :  0.06385 \n    Median       :  0.1449 \n    Mean         :  0.1746703 \n    3r quantile  :  0.2542 \n    Maximum      :  0.5 \n    Missing Rate Overall:  0.06 \n\n  Reporting Minor Allele Frequency (MAF) by Locus OVERALL\n  No. of loci = 703 \n  No. of individuals = 755 \n    Minimum      :  7e-04 \n    1st quantile :  0.0618 \n    Median       :  0.1443 \n    Mean         :  0.1711869 \n    3r quantile  :  0.254425 \n    Maximum      :  0.5 \n    Missing Rate Overall:  0.07 \n\n\n\n\n\n\n\n\n\n   Quantile Threshold Retained Percent Filtered Percent\n1      100%    0.5000        1     0.1      699    99.9\n2       95%    0.4431       36     5.1      664    94.9\n3       90%    0.3812       71    10.1      629    89.9\n4       85%    0.3346      105    15.0      595    85.0\n5       80%    0.2873      141    20.1      559    79.9\n6       75%    0.2537      176    25.1      524    74.9\n7       70%    0.2279      210    30.0      490    70.0\n8       65%    0.2009      246    35.1      454    64.9\n9       60%    0.1779      280    40.0      420    60.0\n10      55%    0.1595      315    45.0      385    55.0\n11      50%    0.1442      351    50.1      349    49.9\n12      45%    0.1210      386    55.1      314    44.9\n13      40%    0.1024      422    60.3      278    39.7\n14      35%    0.0872      455    65.0      245    35.0\n15      30%    0.0755      490    70.0      210    30.0\n16      25%    0.0618      526    75.1      174    24.9\n17      20%    0.0487      561    80.1      139    19.9\n18      15%    0.0346      595    85.0      105    15.0\n19      10%    0.0227      631    90.1       69     9.9\n20       5%    0.0053      666    95.1       34     4.9\n21       0%    0.0007      700   100.0        0     0.0\nCompleted: gl.report.maf \n\nEYR.sloppy &lt;- gl.filter.maf(EYR.sloppy, threshold = 3, verbose = 0, recalc = TRUE)\n\n\n\nFiltering SNPs for sex-linked loci and then with standard filters (“correct filtering”)\nLet’s remove sex-linked markers and then apply standard filters:\n\n# Filter for sex-linked loci\nEYR.correct &lt;- gl.drop.sexlinked(EYR, system = \"zw\")  \n\nStarting gl.drop.sexlinked \n  Processing genlight object with SNP data\n\n\n\n\n\n\n\n\n\nCompleted: gl.drop.sexlinked \n\n# Filter for read depth\nEYR.correct &lt;- gl.filter.rdepth(EYR.correct, lower = 3, upper = 11, verbose = 0)\n\n\n\n\n\n\n\n# Filter for loci call rate\ngl.report.callrate(EYR.correct, method = \"loc\")\n\nStarting gl.report.callrate \n  Processing genlight object with SNP data\n  Reporting Call Rate by Locus\n  No. of loci = 811 \n  No. of individuals = 782 \n    Minimum      :  0.20844 \n    1st quartile :  0.7436065 \n    Median       :  0.900256 \n    Mean         :  0.8192658 \n    3r quartile  :  0.951407 \n    Maximum      :  0.988491 \n    Missing Rate Overall:  0.1807 \n\n   Quantile Threshold Retained Percent Filtered Percent\n1      100%  0.988491        1     0.1      810    99.9\n2       95%  0.979540       46     5.7      765    94.3\n3       90%  0.974425       84    10.4      727    89.6\n4       85%  0.966752      130    16.0      681    84.0\n5       80%  0.957801      165    20.3      646    79.7\n6       75%  0.951407      208    25.6      603    74.4\n7       70%  0.945013      249    30.7      562    69.3\n8       65%  0.936061      289    35.6      522    64.4\n9       60%  0.924552      331    40.8      480    59.2\n10      55%  0.914322      368    45.4      443    54.6\n11      50%  0.900256      408    50.3      403    49.7\n12      45%  0.878517      449    55.4      362    44.6\n13      40%  0.850384      487    60.0      324    40.0\n14      35%  0.823529      531    65.5      280    34.5\n15      30%  0.789003      571    70.4      240    29.6\n16      25%  0.742967      609    75.1      202    24.9\n17      20%  0.672634      649    80.0      162    20.0\n18      15%  0.613811      691    85.2      120    14.8\n19      10%  0.539642      730    90.0       81    10.0\n20       5%  0.402813      771    95.1       40     4.9\n21       0%  0.208440      811   100.0        0     0.0\n\n\n\n\n\n\n\n\n\nCompleted: gl.report.callrate \n\nEYR.correct &lt;- dartR.base::gl.filter.callrate(EYR.correct, method = \"loc\",  threshold = 0.75, verbose = 0, recalc = TRUE)\n\n# Filter for individual call rate\ngl.report.callrate(EYR.correct, method = \"ind\")\n\nStarting gl.report.callrate \n  Processing genlight object with SNP data\n\n  Reporting Call Rate by Individual\n  No. of loci = 605 \n  No. of individuals = 782 \n    Minimum      :  0.03801653 \n    1st quartile :  0.9173554 \n    Median       :  0.9438017 \n    Mean         :  0.9120479 \n    3r quartile  :  0.9586777 \n    Maximum      :  0.9818182 \n    Missing Rate Overall:  0.088 \n\nListing 4 populations and their average CallRates\n  Monitor again after filtering\n  Population CallRate   N\n1     Crusoe   0.9037 238\n2 Muckleford   0.9090 421\n3      Timor   0.9418  52\n4     Wombat   0.9365  71\n\nListing 20 individuals with the lowest CallRates\n  Use this list to see which individuals will be lost on filtering by individual\n  Set ind.to.list parameter to see more individuals\n   Individual Population   CallRate\n1    M18.29.1 Muckleford 0.03801653\n2    M18.18.1 Muckleford 0.04462810\n3    M18.47.2 Muckleford 0.06776860\n4    C18.16.1     Crusoe 0.07438017\n5   027-34168     Crusoe 0.08760331\n6    C18.15.2     Crusoe 0.08760331\n7    C18.21.2     Crusoe 0.08760331\n8    M18.47.3 Muckleford 0.13719008\n9    M18.35.2 Muckleford 0.18016529\n10   M18.20.3 Muckleford 0.24132231\n11   C18.28.1     Crusoe 0.41487603\n12   M20.70.2 Muckleford 0.42644628\n13   C18.17.2     Crusoe 0.44628099\n14  027-34065 Muckleford 0.49586777\n15   C18.14.1     Crusoe 0.49752066\n16  M20.110.1 Muckleford 0.53057851\n17   M20.70.3 Muckleford 0.53553719\n18   M19.12.1 Muckleford 0.54380165\n19    M19.8.1 Muckleford 0.56694215\n20   M19.33.2 Muckleford 0.57851240\n\n)\n\n\n\n\n\n\n\n\n\nCompleted: gl.report.callrate \n\nEYR.correct &lt;- gl.filter.callrate(EYR.correct, method = \"ind\", threshold = 0.65, verbose = 0, recalc = TRUE)\n# Filter for MAC (= 3)\ngl.report.maf(EYR.correct)\n\nStarting gl.report.maf \n  Processing genlight object with SNP data\nStarting gl.report.maf \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Crusoe \n  No. of loci = 573 \n  No. of individuals = 231 \n    Minimum      :  0.0022 \n    1st quantile :  0.06 \n    Median       :  0.1488 \n    Mean         :  0.1741178 \n    3r quantile  :  0.2646 \n    Maximum      :  0.4975 \n    Missing Rate Overall:  0.08 \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Muckleford \n  No. of loci = 585 \n  No. of individuals = 401 \n    Minimum      :  0.0013 \n    1st quantile :  0.055 \n    Median       :  0.129 \n    Mean         :  0.1639928 \n    3r quantile  :  0.2474 \n    Maximum      :  0.4985 \n    Missing Rate Overall:  0.07 \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Timor \n  No. of loci = 504 \n  No. of individuals = 52 \n    Minimum      :  0.0096 \n    1st quantile :  0.068275 \n    Median       :  0.1635 \n    Mean         :  0.1898613 \n    3r quantile  :  0.286075 \n    Maximum      :  0.5 \n    Missing Rate Overall:  0.06 \n\n  Reporting Minor Allele Frequency (MAF) by Locus for population Wombat \n  No. of loci = 536 \n  No. of individuals = 71 \n    Minimum      :  0.007 \n    1st quantile :  0.062475 \n    Median       :  0.13805 \n    Mean         :  0.1706063 \n    3r quantile  :  0.2509 \n    Maximum      :  0.5 \n    Missing Rate Overall:  0.06 \n\n  Reporting Minor Allele Frequency (MAF) by Locus OVERALL\n  No. of loci = 605 \n  No. of individuals = 755 \n    Minimum      :  7e-04 \n    1st quantile :  0.05815 \n    Median       :  0.13255 \n    Mean         :  0.1628168 \n    3r quantile  :  0.243425 \n    Maximum      :  0.5 \n    Missing Rate Overall:  0.07 \n\n\n\n\n\n\n\n\n\n   Quantile Threshold Retained Percent Filtered Percent\n1      100%    0.5000        1     0.2      601    99.8\n2       95%    0.4364       31     5.1      571    94.9\n3       90%    0.3714       61    10.1      541    89.9\n4       85%    0.3207       91    15.1      511    84.9\n5       80%    0.2734      121    20.1      481    79.9\n6       75%    0.2436      151    25.1      451    74.9\n7       70%    0.2127      181    30.1      421    69.9\n8       65%    0.1901      211    35.0      391    65.0\n9       60%    0.1714      241    40.0      361    60.0\n10      55%    0.1499      271    45.0      331    55.0\n11      50%    0.1320      302    50.2      300    49.8\n12      45%    0.1092      332    55.1      270    44.9\n13      40%    0.0950      362    60.1      240    39.9\n14      35%    0.0806      393    65.3      209    34.7\n15      30%    0.0710      422    70.1      180    29.9\n16      25%    0.0580      452    75.1      150    24.9\n17      20%    0.0447      482    80.1      120    19.9\n18      15%    0.0305      512    85.0       90    15.0\n19      10%    0.0194      542    90.0       60    10.0\n20       5%    0.0048      572    95.0       30     5.0\n21       0%    0.0007      602   100.0        0     0.0\nCompleted: gl.report.maf \n\nEYR.correct &lt;- dartR.base::gl.filter.maf(EYR.correct, threshold = 3, verbose = 0, recalc = TRUE)\n\n\n\n2.1. Differences in PCoA between “sloppily filtered” dataset (only standard filters), vs “correctly filtered” dataset (gl.drop.sexlinked and standard filters)\n\n# Sloppy\nPCA.sloppy &lt;- gl.pcoa(EYR.sloppy, verbose = 0)\n\n\n\n\n\n\n\npcplot_sloppy &lt;- gl.pcoa.plot(PCA.sloppy, EYR.sloppy, xaxis = 1, yaxis = 2)\n\n\n\n\n\n\n\n# Correct\nPCA.correct &lt;- gl.pcoa(EYR.correct, verbose = 0)\n\n\n\n\n\n\n\npcplot_correct &lt;- gl.pcoa.plot(PCA.correct, EYR.correct, xaxis = 1, yaxis = 2)\n\n\n\n\n\n\n\n\nStarting gl.colors \nSelected color type 2 \nCompleted: gl.colors \nStarting gl.pcoa.plot \n  Processing an ordination file (glPca)\n  Processing genlight object with SNP data\n  Plotting populations in a space defined by the SNPs\n  Preparing plot .... please wait\nCompleted: gl.pcoa.plot \nStarting gl.colors \nSelected color type 2 \nCompleted: gl.colors \nStarting gl.pcoa.plot \n  Processing an ordination file (glPca)\n  Processing genlight object with SNP data\n  Plotting populations in a space defined by the SNPs\n  Preparing plot .... please wait\nCompleted: gl.pcoa.plot \n\n\n\n\n\n\n\n\nNote\n\n\n\nQuestion: Do the PCoA plots look different? Why?\n\n\n\n\n2.2. Differences in genetic diversity and fixation indices between “sloppily filtered” dataset vs “correctly filtered” dataset\nLet’s check some basic stats:\n\nbasic.sloppy  &lt;- utils.basic.stats(EYR.sloppy)\nbasic.correct &lt;- utils.basic.stats(EYR.correct)\nbasic.sloppy$overall\n\n     Ho      Hs      Ht     Dst     Htp    Dstp     Fst    Fstp     Fis    Dest \n 0.1638  0.2442  0.2537  0.0095  0.2568  0.0126  0.0373  0.0491  0.3294  0.0167 \nGst_max   Gst_H \n 0.7061  0.0696 \n\nbasic.correct$overall\n\n     Ho      Hs      Ht     Dst     Htp    Dstp     Fst    Fstp     Fis    Dest \n 0.1631  0.2379  0.2459  0.0080  0.2485  0.0107  0.0325  0.0429  0.3144  0.0140 \nGst_max   Gst_H \n 0.7135  0.0601 \n\n\n\n\n\n\n\n\nNote\n\n\n\nQuestion: Why are observed Heterozygosity (Ho) and expected Heterozygosity (He) slightly higher for the “sloppyly filtered” dataset? Hint: Look at the second plot produced by function gl.report.sexlinked.\n\n\nCalculate FST fixation indices between populations:\n\ngl.fst.pop(EYR.sloppy, verbose = 0)\n\n               Crusoe Muckleford      Timor Wombat\nCrusoe             NA         NA         NA     NA\nMuckleford 0.03234709         NA         NA     NA\nTimor      0.04072932 0.05451318         NA     NA\nWombat     0.05484958 0.02376727 0.08401313     NA\n\ngl.fst.pop(EYR.correct, verbose = 0)\n\n               Crusoe Muckleford      Timor Wombat\nCrusoe             NA         NA         NA     NA\nMuckleford 0.02795813         NA         NA     NA\nTimor      0.03987369 0.04810759         NA     NA\nWombat     0.04446378 0.02270137 0.07114017     NA\n\n\n\n\n\n\n\n\nNote\n\n\n\nQuestion: Which dataset has higher FST estimates overall?",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bonus! Sex Linked Markers</span>"
    ]
  },
  {
    "objectID": "session08.html#further-study",
    "href": "session08.html#further-study",
    "title": "8  Bonus! Sex Linked Markers",
    "section": "Further Study",
    "text": "Further Study\n\nReadings\nRobledo-Ruiz et al. (2023)\n\n\n\n\nRobledo-Ruiz, Diana A., Lana Austin, J. Nevil Amos, Jesús Castrejón-Figueroa, Daniel K. P. Harley, Michael J. L. Magrath, Paul Sunnucks, and Alexandra Pavlova. 2023. “Easy-to-Use R Functions to Separate Reduced-Representation Genomic Datasets into Sex-Linked and Autosomal Loci, and Conduct Sex Assignment.” Molecular Ecology Resources 0 (n/a). https://doi.org/10.1111/1755-0998.13844.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Bonus! Sex Linked Markers</span>"
    ]
  },
  {
    "objectID": "break.html",
    "href": "break.html",
    "title": "__________",
    "section": "",
    "text": "Everything beyond this point is for added learning, we hope you have fun exploring all the amazing things the dartRverse has to offer.",
    "crumbs": [
      "\\__________"
    ]
  },
  {
    "objectID": "tutorials.html",
    "href": "tutorials.html",
    "title": "dartR Tutorials",
    "section": "",
    "text": "Prerequistes",
    "crumbs": [
      "dartR Tutorials"
    ]
  },
  {
    "objectID": "tutorials.html#prerequistes",
    "href": "tutorials.html#prerequistes",
    "title": "dartR Tutorials",
    "section": "",
    "text": "RStudio Refresher\nUnable to display PDF file. Download instead.\n\n\ndartR Installation\nUnable to display PDF file. Download instead.",
    "crumbs": [
      "dartR Tutorials"
    ]
  },
  {
    "objectID": "tutorials.html#fundamentals",
    "href": "tutorials.html#fundamentals",
    "title": "dartR Tutorials",
    "section": "Fundamentals",
    "text": "Fundamentals\n\ndartR Data Structure and Input\nUnable to display PDF file. Download instead.\n\n\ndartR Data Manipulation\nUnable to display PDF file. Download instead.\n\n\ndartR Basic Filtering\nUnable to display PDF file. Download instead.",
    "crumbs": [
      "dartR Tutorials"
    ]
  },
  {
    "objectID": "powerpoints.html",
    "href": "powerpoints.html",
    "title": "Powerpoints",
    "section": "",
    "text": "Session 1",
    "crumbs": [
      "Powerpoints"
    ]
  },
  {
    "objectID": "powerpoints.html#session-1",
    "href": "powerpoints.html#session-1",
    "title": "Powerpoints",
    "section": "",
    "text": "Download Session 1 powerpoint",
    "crumbs": [
      "Powerpoints"
    ]
  },
  {
    "objectID": "powerpoints.html#session-8",
    "href": "powerpoints.html#session-8",
    "title": "Powerpoints",
    "section": "Session 8",
    "text": "Session 8\n\n\n\n\n\n\n Download Session 8 powerpoint",
    "crumbs": [
      "Powerpoints"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Gruber, Bernd, Peter J. Unmack, Oliver F. Berry, and Arthur Georges.\n2018. “DARTR : An R Package\nto Facilitate Analysis of SNP Data Generated from Reduced\nRepresentation Genome Sequencing.” Molecular Ecology\nResources 18 (3): 691–99. https://doi.org/10.1111/1755-0998.12745.\n\n\nJombart, T., and I. Ahmed. 2011. “Adegenet 1.3-1: New Tools for\nthe Analysis of Genome-Wide SNP Data.” Bioinformatics.\nhttps://doi.org/10.1093/bioinformatics/btr521.\n\n\nMijangos, Jose Luis, Bernd Gruber, Oliver Berry, Carlo Pacioni, and\nArthur Georges. 2022. “dartR V2:\nAn Accessible Genetic Analysis Platform for Conservation,\nEcology and Agriculture.” Methods in Ecology and\nEvolution 13 (10): 2150–58. https://doi.org/10.1111/2041-210X.13918.\n\n\nRobledo-Ruiz, Diana A., Lana Austin, J. Nevil Amos, Jesús\nCastrejón-Figueroa, Daniel K. P. Harley, Michael J. L. Magrath, Paul\nSunnucks, and Alexandra Pavlova. 2023. “Easy-to-Use R\nFunctions to Separate Reduced-Representation Genomic Datasets into\nSex-Linked and Autosomal Loci, and Conduct Sex Assignment.”\nMolecular Ecology Resources 0 (n/a). https://doi.org/10.1111/1755-0998.13844.",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "feedback.html",
    "href": "feedback.html",
    "title": "Feedback",
    "section": "",
    "text": "Please provide any questions, suggestions, or praises in the message box below and then hit submit.\n\nName: \nEmail: \nMessage:",
    "crumbs": [
      "Feedback"
    ]
  }
]